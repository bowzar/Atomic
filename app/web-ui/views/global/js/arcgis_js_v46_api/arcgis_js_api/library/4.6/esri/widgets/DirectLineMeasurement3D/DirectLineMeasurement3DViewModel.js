// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.6/esri/copyright.txt for details.
//>>built
define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/HandleRegistry ../../core/Accessor ../../core/watchUtils ../../core/Logger ../../geometry/support/scaleUtils ../../views/3d/interactive/measurementTools/pointToPoint/PointToPointMeasurementTool".split(" "),function(u,v,h,d,c,k,l,e,m,n,p){var f={text:"",visible:!1},q="metric imperial inches feet yards miles nautical-miles us-feet meters kilometers".split(" "),
r="metric imperial inches feet yards miles nautical-miles us-feet meters kilometers".split(" "),t=m.getLogger("esri.widgets.DirectLineMeasurement3D.DirectLineMeasurement3DViewModel");return function(g){function a(b){b=g.call(this,b)||this;b._handles=new k;b._userSelectableUnits=null;b._userUnit=null;b.view=null;b.visible=!0;b.tool=null;return b}h(a,g);a.prototype.initialize=function(){var b=this;this._handles.add([e.init(this,["view.ready","visible"],function(){b._toggleTool()}),e.init(this,"unit",
function(a){b.tool&&(b.tool.unit=a)})])};a.prototype.destroy=function(){this.view=null;this._toggleTool();this._handles.destroy();this._handles=null};Object.defineProperty(a.prototype,"state",{get:function(){var b=!!this.get("view.ready"),a=this.get("view.type");return b&&"3d"===a?this.get("tool.isMeasuring")?"measure":"hint":(b&&"3d"!==a&&t.error("DirectLineMeasurement3D widget is not implemented for MapView"),b?"unsupported":"disabled")},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"defaultUnit",{get:function(){return this.defaultUnitFromPortal||this.defaultUnitFromSpatialReference||"metric"},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"defaultUnitFromSpatialReference",{get:function(){var b=this.view&&this.view.spatialReference;if(!b)return null;switch(n.getUnitString(b)){case "feet":case "us-feet":case "clarke-feet":case "clarke-yards":case "clarke-links":case "sears-yards":case "sears-feet":case "sears-chains":case "benoit-1895-b-chains":case "indian-yards":case "indian-1937-yards":case "gold-coast-feet":case "sears-1922-truncated-chains":return"imperial";
case "50-kilometers":case "150-kilometers":case "meters":return"metric"}return null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"defaultUnitFromPortal",{get:function(){var b=this.get("view.map.portalItem.portal");if(!b)return null;switch(b.user&&b.user.units||b.units){case "metric":return"metric";case "english":return"imperial";default:return null}},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"directLabel",{get:function(){return this.tool?{text:this.tool.triangleView.directLabel,
visible:!!this.tool.triangleView.directLabel&&"geodesic"!==this.tool.model.measurementMode}:f},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"horizontalLabel",{get:function(){return this.tool?{text:this.tool.triangleView.horizontalLabel,visible:!!this.tool.triangleView.horizontalLabel}:f},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"verticalLabel",{get:function(){return this.tool?{text:this.tool.triangleView.verticalLabel,visible:!!this.tool.triangleView.verticalLabel}:
f},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"selectableUnits",{get:function(){return this._filteredOrAllUnits(this._userSelectableUnits)},set:function(b){this._userSelectableUnits=b;this._set("selectableUnits",this._filteredOrAllUnits(this._userSelectableUnits))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"unit",{get:function(){return this._userUnit?this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit):this._findSelectableUnit(this.defaultUnit)},
set:function(b){this._userUnit=this._findSelectableUnit(b,this._userUnit);this.notifyChange("unit")},enumerable:!0,configurable:!0});a.prototype.clearMeasurement=function(){this.tool&&this.tool.clearMeasurement()};a.prototype._toggleTool=function(){var b=this;this.tool&&(this.tool.destroy(),this._set("tool",null));this.visible&&this.view&&this._handles.add(e.whenOnce(this.view,"ready",function(){b._set("tool",new p({view:b.view,unit:b.unit}));b.tool.start()}))};a.prototype._findSelectableUnit=function(b,
a){var c=this.selectableUnits;return-1!==c.indexOf(b)?b:a?this._findSelectableUnit(a):c[0]};a.prototype._filteredOrAllUnits=function(a){var b=this.view&&this.view.spatialReference,c=b&&(b.isWebMercator||b.isWGS84)?q:r;if(!a)return c.slice();a=a.filter(function(a){return-1!==c.indexOf(a)});return 0===a.length?c.slice():a};d([c.property({dependsOn:["view.ready","tool.isMeasuring"],readOnly:!0})],a.prototype,"state",null);d([c.property()],a.prototype,"view",void 0);d([c.property()],a.prototype,"visible",
void 0);d([c.property({readOnly:!0})],a.prototype,"tool",void 0);d([c.aliasOf("tool.directDistance")],a.prototype,"directDistance",void 0);d([c.aliasOf("tool.horizontalDistance")],a.prototype,"horizontalDistance",void 0);d([c.aliasOf("tool.verticalDistance")],a.prototype,"verticalDistance",void 0);d([c.aliasOf("tool.geodesicDistance")],a.prototype,"geodesicDistance",void 0);d([c.aliasOf("tool.geodesicAngle")],a.prototype,"geodesicAngle",void 0);d([c.aliasOf("tool.isMeasuring")],a.prototype,"isMeasuring",
void 0);d([c.property({readOnly:!0,dependsOn:["defaultUnitFromPortal","defaultUnitFromSpatialReference"]})],a.prototype,"defaultUnit",null);d([c.property({readOnly:!0,dependsOn:["view.spatialReference"]})],a.prototype,"defaultUnitFromSpatialReference",null);d([c.property({readOnly:!0,dependsOn:["view.map.portalItem.portal.units","view.map.portalItem.portal.user.units"]})],a.prototype,"defaultUnitFromPortal",null);d([c.property({readOnly:!0,dependsOn:["tool.triangleView"]})],a.prototype,"directLabel",
null);d([c.property({readOnly:!0,dependsOn:["tool.triangleView"]})],a.prototype,"horizontalLabel",null);d([c.property({readOnly:!0,dependsOn:["tool.triangleView"]})],a.prototype,"verticalLabel",null);d([c.property({dependsOn:["view.spatialReference"]})],a.prototype,"selectableUnits",null);d([c.property({dependsOn:["selectableUnits","defaultUnit"]})],a.prototype,"unit",null);d([c.property()],a.prototype,"clearMeasurement",null);return a=d([c.subclass("esri.widgets.DirectLineMeasurement3D.DirectLineMeasurement3DViewModel")],
a)}(c.declared(l))});