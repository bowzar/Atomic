// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.6/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../../webgl/VertexArrayObject","../Utils"],function(u,v,h,m){return function(){function k(){this._lineAttributeLocations={a_pos:0,a_id:1,a_color:2,a_offsetAndNormal:3,a_accumulatedDistanceAndHalfWidth:4,a_tlbr:5,a_segmentDirection:6};this._lineAttributeLocationsVV={a_pos:0,a_id:1,a_color:2,a_offsetAndNormal:3,a_accumulatedDistanceAndHalfWidth:4,a_tlbr:5,a_segmentDirection:6,a_vv:7};this._lineVertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,
stride:32,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:32,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:32,normalized:!0,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:12,stride:32,normalized:!1,divisor:0},{name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123,offset:16,stride:32,normalized:!1,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:20,stride:32,normalized:!1,divisor:0},{name:"a_segmentDirection",count:4,type:5120,
offset:28,stride:32,normalized:!1,divisor:0}]};this._lineVertexAttributeLayoutVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:44,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:44,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:44,normalized:!0,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:12,stride:44,normalized:!1,divisor:0},{name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123,offset:16,stride:44,normalized:!1,
divisor:0},{name:"a_tlbr",count:4,type:5123,offset:20,stride:44,normalized:!1,divisor:0},{name:"a_segmentDirection",count:4,type:5120,offset:28,stride:44,normalized:!1,divisor:0},{name:"a_vv",count:3,type:5126,offset:32,stride:44,normalized:!1,divisor:0}]};this._spritesTextureSize=new Float32Array(2)}k.prototype.draw=function(c,b,f,d,a,k,h,q,r,l,n,t){var e=b.materialKeyInfo,g=e.vvSizeMinMaxValue||e.vvSizeScaleStops||e.vvSizeFieldStops||e.vvSizeUnitValue||e.vvColor||e.vvOpacity;if(a=l.getProgram(b.materialKey,
a,g?this._lineAttributeLocationsVV:this._lineAttributeLocations)){c.bindProgram(a);g=this._getVAO(c,f,g);c.bindVAO(g);g=1/h;if(0<b.texBindingInfo.length){b=b.texBindingInfo[0];l=b.pageId;var p=n.sprites;this._spritesTextureSize[0]=p.getWidth(l);this._spritesTextureSize[1]=p.getHeight(l);n.bindSpritePage(c,l,b.unit);a.setUniform1i(b.semantic,b.unit);a.setUniform2fv("u_mosaicSize",this._spritesTextureSize);a.setUniform1f("u_zoomFactor",Math.pow(2,k-f.key.level)/h);a.setUniform1f("u_tileCoordRatio",
m.C_TILE_SIZE/f.coordRange)}a.setUniformMatrix4fv("u_transformMatrix",f.tileTransform.transform);a.setUniformMatrix4fv("u_extrudeMatrix",t);a.setUniform2fv("u_normalized_origin",f.tileTransform.displayCoord);a.setUniform1f("u_opacity",1);a.setUniform1f("u_blur",0+g);a.setUniform1f("u_antialiasing",g);e.vvSizeMinMaxValue&&a.setUniform4fv("u_vvSizeMinMaxValue",d.vvSizeMinMaxValue);e.vvSizeScaleStops&&a.setUniform1f("u_vvSizeScaleStopsValue",d.vvSizeScaleStopsValue);e.vvSizeFieldStops&&(a.setUniform1fv("u_vvSizeFieldStopsValues",
d.vvSizeFieldStopsValues),a.setUniform1fv("u_vvSizeFieldStopsSizes",d.vvSizeFieldStopsSizes));e.vvSizeUnitValue&&a.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",d.vvSizeUnitValueToPixelsRatio);e.vvColor&&(a.setUniform1fv("u_vvColorValues",d.vvColorValues),a.setUniform4fv("u_vvColors",d.vvColors));e.vvOpacity&&(a.setUniform1fv("u_vvOpacityValues",d.vvOpacityValues),a.setUniform1fv("u_vvOpacities",d.vvOpacities));c.setFaceCullingEnabled(!0);c.setFrontFace(2305);c.setCullFace(1029);c.drawElements(4,
r,5125,4*q);c.setFaceCullingEnabled(!1);c.bindVAO(null)}};k.prototype._getVAO=function(c,b,f){if(b.lineGeometry.vao)return b.lineGeometry.vao;var d=b.lineGeometry.vertexBufferMap[m.C_VBO_GEOMETRY],a=b.lineGeometry.indexBuffer;if(!d||!a)return null;b.lineGeometry.vao=f?new h(c,this._lineAttributeLocationsVV,this._lineVertexAttributeLayoutVV,{geometry:d},a):new h(c,this._lineAttributeLocations,this._lineVertexAttributeLayout,{geometry:d},a);return b.lineGeometry.vao};return k}()});