// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.6/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../input/recognizers/PointerClickHoldAndDrag ./Keys ../../../core/Accessor ./DrawAction ../../../core/Evented ../../../core/HandleRegistry ../../../geometry/ScreenPoint".split(" "),function(u,v,h,f,e,k,l,m,n,p,q,g){var r=function(){function d(c,a,b){this.view=c;this.native=a;this.coordinates=b;this.defaultPrevented=!1;this.type="cursor-update"}d.prototype.preventDefault=
function(){this.defaultPrevented=!0};return d}(),t=function(){function d(c,a){this.native=c;this.coordinates=a;this.defaultPrevented=!1;this.type="draw-complete"}d.prototype.preventDefault=function(){this.defaultPrevented=!0};return d}();return function(d){function c(){var a=null!==d&&d.apply(this,arguments)||this;a._clickDelay=k.DefaultParameters.maximumClickDelay;a._cursorMoved=!1;a._cursorScreenPoint=null;a._pointerDownEvent=null;a._viewHandles=new q;a.coordinates=[];a.view=null;return a}h(c,d);
c.prototype.initialize=function(){this._addViewHandles()};c.prototype.destroy=function(){this._removeViewHandles();this._viewHandles.destroy();this.emit("destroy")};c.prototype.complete=function(){this._cursorScreenPoint&&(this._set("coordinates",this.getCoordsFromScreenPoint(this._cursorScreenPoint)),this._drawCompleteHandler(null))};c.prototype._addViewHandles=function(){var a=this;this._removeViewHandles();this._viewHandles.add([this.view.on("click",function(b){a._set("coordinates",a.getCoordsFromScreenPoint(b.screenPoint));
a._drawCompleteHandler(b.native)}),this.view.on("pointer-down",function(b){a._pointerDownEvent=b;a._cursorMoved=!1}),this.view.on("pointer-move",function(b){a._cursorMoved=!0;a._cursorScreenPoint=new g({x:b.x,y:b.y});var c=a.getCoordsFromScreenPoint(a._cursorScreenPoint);a._cursorUpdateHandler(b.native,c)}),this.view.on("pointer-up",function(b){a._pointerDownEvent&&!a._cursorMoved&&b.timestamp-a._pointerDownEvent.timestamp>a._clickDelay&&(a._cursorScreenPoint=new g({x:b.x,y:b.y}),a._set("coordinates",
a.getCoordsFromScreenPoint(a._cursorScreenPoint)),a._drawCompleteHandler(b.native))}),this.view.on("key-down",function(b){b.key===l.KEYS.drawCompleteKey&&a._cursorScreenPoint&&(a._set("coordinates",a.getCoordsFromScreenPoint(a._cursorScreenPoint)),a._drawCompleteHandler(b.native))})])};c.prototype._removeViewHandles=function(){this._viewHandles.removeAll()};c.prototype._cursorUpdateHandler=function(a,b){a=new r(this.view,a,b);this.emit("cursor-update",a)};c.prototype._drawCompleteHandler=function(a){this._cursorMoved=
!1;this._pointerDownEvent=null;a=new t(a,this.coordinates);this.emit("draw-complete",a);a.defaultPrevented||this._removeViewHandles()};f([e.property()],c.prototype,"coordinates",void 0);f([e.property()],c.prototype,"view",void 0);return c=f([e.subclass("esri.views.2d.draw.PointDrawAction")],c)}(e.declared(n,m,p))});