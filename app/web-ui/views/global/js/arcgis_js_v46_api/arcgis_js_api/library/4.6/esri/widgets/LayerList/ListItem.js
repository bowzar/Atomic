// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.6/esri/copyright.txt for details.
//>>built
define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Collection ../../support/Action ../../layers/support/Sublayer ../../core/Identifiable ../../core/HandleRegistry ../../core/watchUtils ./support/layerListUtils ../../core/accessorSupport/decorators".split(" "),function(u,v,m,d,n,f,p,q,r,t,h,g,c){var k=f.ofType(f.ofType(p));return function(l){function a(b){b=l.call(this)||this;b._handles=new t;b.actionsSections=new k;
b.actionsOpen=!1;b.children=new (f.ofType(e));b.error=null;b.layer=null;b.open=!1;b.parent=null;b.view=null;b.visible=null;return b}m(a,l);e=a;a.prototype.initialize=function(){var b=this;this._handles.add([h.init(this,"layer",function(a){return b._watchLayerProperties(a)}),h.init(this,"view",function(a){return b._updateChildren(a)})])};a.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null};Object.defineProperty(a.prototype,"layerView",{get:function(){return this._findLayerView(this.layer)||
null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"title",{get:function(){var b=this.get("layer.layer");return(!b||b&&this.get("layer.layer.loaded"))&&this.get("layer.title")||""},set:function(b){void 0===b?this._clearOverride("title"):this._override("title",b)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"updating",{get:function(){var b=this.layerView;return b?b.updating:this._isLayerUpdating(this.layer)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"visibleAtCurrentScale",{get:function(){return!g.isLayerOutsideScaleRange(this.layer,this.get("view.scale"))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"visibilityMode",{get:function(){return g.findLayerVisibilityMode(this.layer)||"independent"},enumerable:!0,configurable:!0});a.prototype.clone=function(){return new e({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,children:this.children.clone(),layer:this.layer,open:this.open,title:this.title,view:this.view,
visible:this.visible})};a.prototype._updateChildren=function(b){var a=this.children;a&&a.forEach(function(a){return a.view=b})};a.prototype._addChildren=function(b){var a=this;this.children.removeAll();if(b){var c=[];b.forEach(function(b){g.canDisplayLayer(b)&&(b=new e({layer:b,parent:a,view:a.view}),c.unshift(b))});this.children.addMany(c)}};a.prototype._watchSublayerChanges=function(b){var a=this;b&&this._handles.add(b.on("change",function(){a._addChildren(b)}),"layer")};a.prototype._initializeChildLayers=
function(b){this._addChildren(b);this._watchSublayerChanges(b)};a.prototype._watchLayerProperties=function(b){var a=this;if(this._handles&&(this._handles.remove("layer"),b)){var c=g.getNormalizedChildLayerProperty(b);c&&this._handles.add(h.init(b,c,function(){b.hasOwnProperty(c)&&a._initializeChildLayers(b[c])}),"layer")}};a.prototype._findLayerView=function(b){if(b){var a=this.get("view.allLayerViews");if(a)return a.find(function(a){return a.layer===b})}};a.prototype._isLayerUpdating=function(a){return a instanceof
q?!1:"loading"===a.loadStatus};d([c.property({type:k})],a.prototype,"actionsSections",void 0);d([c.property()],a.prototype,"actionsOpen",void 0);d([c.property({type:f})],a.prototype,"children",void 0);d([c.aliasOf("layer.loadError")],a.prototype,"error",void 0);d([c.property()],a.prototype,"layer",void 0);d([c.property({dependsOn:["layer","view"],readOnly:!0})],a.prototype,"layerView",null);d([c.property()],a.prototype,"open",void 0);d([c.property()],a.prototype,"parent",void 0);d([c.property({dependsOn:["layer.layer.loaded",
"layer.title"]})],a.prototype,"title",null);d([c.property({dependsOn:["layer.loadStatus","layerView.updating"],readOnly:!0})],a.prototype,"updating",null);d([c.property({value:null})],a.prototype,"view",void 0);d([c.aliasOf("layer.visible")],a.prototype,"visible",void 0);d([c.property({dependsOn:["layer.minScale","layer.maxScale","view.scale"],readOnly:!0})],a.prototype,"visibleAtCurrentScale",null);d([c.property({dependsOn:["layer.visibilityMode"],readOnly:!0})],a.prototype,"visibilityMode",null);
return a=e=d([c.subclass("esri.widgets.LayerList.ListItem")],a);var e}(c.declared(n,r))});