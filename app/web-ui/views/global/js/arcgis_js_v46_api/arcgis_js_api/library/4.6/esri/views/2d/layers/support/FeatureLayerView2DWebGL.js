// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.6/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/engine/webgl/rendererInfoUtils":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../support/arcadeUtils ../../../../arcade/Feature ./visualVariablesUtils".split(" "),function(n,h,d,a,c,g){function e(b,k){if(!b)return null;var e=0,l={};b=b.clone();var g=b.valueExpression,p=b.visualVariables,q=null;if(!b.field&&g){f||(f=new c(null));var r="$$fake"+e++,u=a.createFunction(g);l[r]=function(b,e){f.attributes=b.attributes;return a.executeFunction(u,
{vars:{$feature:f,$view:a.getViewInfo(e)},spatialReference:k})};b.field=r;b.valueExpression=null;q=function(b,a){a.attributes[r]=l[r](a);return b.getSymbol(a)}}p&&(b.visualVariables=p.map(function(b){if(b.normalizationField){var m=b.field,q=b.normalizationField,g="$$fake"+e++;l[g]=function(b,a){return b.attributes[m]/b.attributes[q]};b=d({},b);b.field=g;delete b.normalizationField;return b}if(b.valueExpression&&"$view.scale"!==b.valueExpression){var p=b.valueExpression,g="$$fake"+e++,t=a.createFunction(p);
f||(f=new c(null));l[g]=function(b,e){f.attributes=b.attributes;return a.executeFunction(t,{vars:{$feature:f,$view:a.getViewInfo(e)},spatialReference:k})};b=d({},b);b.field=g;delete b.valueExpression}return b}));return{renderer:b,normalizingFunctions:l,getSymbolFunction:q}}Object.defineProperty(h,"__esModule",{value:!0});var f;h.createRendererInfo=function(b,a){var f=(a=e(b,a)||{renderer:null,normalizingFunctions:null,getSymbolFunction:null},a.normalizingFunctions),c=a&&a.getSymbolFunction;b=a&&a.renderer||
b;a=null;if("heatmap"===b.type){var d=b.offset;a=9*Math.round(b.blurRadius)+1;a={getIntensity:function(b){return"function"===typeof b?b:b?"abs"===d?function(a){return Math.abs(a.attributes[b])}:function(a){return a.attributes[b]+d}:function(b){return 1}}(b.field),kernelSize:a,radius:b.blurRadius}}var k=g.convertVisualVariables(b.visualVariables);return{renderer:b,vvFields:k.vvFields,vvRanges:k.vvRanges,heatmapInfo:a,getValue:function(b,a){var e=f[a];return e?e(b):b.attributes[a]},getSymbol:function(b){return c?
c(this.renderer,b):this.renderer.getSymbol?this.renderer.getSymbol(b):null}}};h.getNormalizedRenderer=function(b,a){return(a=e(b,a)||{renderer:null,normalizingFunctions:null,getSymbolFunction:null},a.renderer)||b};h.getSymbol=function(b,a){return b.getSymbol(a)}})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define("require exports ../../../../core/screenUtils ../../../3d/layers/support/FastSymbolUpdates ./Utils ./enums".split(" "),function(n,h,d,a,c,g){function e(b){return c.isNumber(b.minDataValue)&&
c.isNumber(b.maxDataValue)&&null!=b.minSize&&null!=b.maxSize?g.WGLVVFlag.SIZE_MINMAX_VALUE:(b.expression&&"view.scale"===b.expression||b.valueExpression&&"$view.scale"===b.valueExpression)&&Array.isArray(b.stops)?g.WGLVVFlag.SIZE_SCALE_STOPS:(null!=b.field||b.expression&&"view.scale"!==b.expression||b.valueExpression&&"$view.scale"!==b.valueExpression)&&Array.isArray(b.stops)?g.WGLVVFlag.SIZE_FIELD_STOPS:(null!=b.field||b.expression&&"view.scale"!==b.expression||b.valueExpression&&"$view.scale"!==
b.valueExpression)&&null!=b.valueUnit?g.WGLVVFlag.SIZE_UNIT_VALUE:g.WGLVVFlag.NONE}function f(b){return{value:b.value,size:d.toPt(b.size)}}function b(b){return b.map(function(b){return f(b)})}function k(a){return"string"===typeof a||"number"===typeof a?d.toPt(a):{type:"size",expression:a.expression,stops:b(a.stops)}}function m(b){var a={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if(c.isString(b.field))if(b.stops){if(8<b.stops.length)return null;b=b.stops;for(var f=0;8>f;++f){var e=b[Math.min(f,
b.length-1)];a.values[f]=e.value;a.opacities[f]=e.opacity}}else if(b.opacityValues){if(!c.isDefined(b.minDataValue)||!c.isDefined(b.maxDataValue)||2!==b.opacityValues.length)return null;a.values[0]=b.minDataValue;a.opacities[0]=b.opacityValues[0];a.values[1]=b.maxDataValue;a.opacities[1]=b.opacityValues[1];for(f=2;8>f;++f)a.values[f]=b.maxDataValue,a.opacities[f]=b.opacityValues[1]}else return null;else if(b.stops&&0<=b.stops.length||b.opacityValues&&0<=b.opacityValues.length)for(b=b.stops&&0<=b.stops.length?
b.stops[0].opacity:b.opacityValues[0],f=0;8>f;f++)a.values[f]=Infinity,a.opacities[f]=b;else return null;return a}Object.defineProperty(h,"__esModule",{value:!0});h.getTypeOfSizeVisualVariable=e;h.getVisualVariableSizeValueRepresentationRatio=function(b,a){if(!b||!a)return b;switch(a){case "radius":case "distance":return 2*b;case "area":return Math.sqrt(b)}return b};h.stopToSizeStop=f;h.normalizeSizeStops=b;h.normalizeSizeElement=k;h.getVisualVariablesFields=function(b){var a=b&&0<b.length?{}:null;
a&&b.forEach(function(b){var f=b.type;b.field&&(a[f]=b.field)});return a};h.convertVisualVariables=function(f){var l=f&&0<f.length?{}:null,p=l?{}:null;l&&f.forEach(function(f){var q=f.type;f.field&&(l[q]=f.field);if("size"===q)switch(p.size||(p.size={}),e(f)){case g.WGLVVFlag.SIZE_MINMAX_VALUE:p.size.minMaxValue={minDataValue:f.minDataValue,maxDataValue:f.maxDataValue,minSize:k(f.minSize),maxSize:k(f.maxSize)};break;case g.WGLVVFlag.SIZE_SCALE_STOPS:p.size.scaleStops={stops:b(f.stops)};break;case g.WGLVVFlag.SIZE_FIELD_STOPS:var q=
[],u=[];f=b(f.stops);for(var t=f.length,h=0;6>h;h++){var D=f[Math.min(h,t-1)];q.push(D.value);u.push(d.pt2px(D.size))}p.size.fieldStops={values:q,sizes:u};break;case g.WGLVVFlag.SIZE_UNIT_VALUE:p.size.unitValue={unit:f.valueUnit,valueRepresentation:f.valueRepresentation}}else if("color"===q)for(q=a.convertVisualVariables([f],{modelSize:null,symbolSize:null,unitInMeters:1,transformation:null}),p.color=q.color,h=0;32>h;h+=4)c.premultiplyAlpha(p.color.colors,h,!0);else"opacity"===q?p.opacity=m(f):"rotation"===
q&&(p.rotation={type:f.rotationType})});return{vvFields:l,vvRanges:p}}})},"esri/views/3d/layers/support/FastSymbolUpdates":function(){define(["require","exports","../../../../renderers/support/utils","../../lib/glMatrix","../graphics/graphicUtils"],function(n,h,d,a,c){function g(b){return null!==b&&void 0!==b}function e(b){return"number"===typeof b}function f(b,a){b&&b.push(a)}function b(b,a,c,m,q){var l=b.minSize,p=b.maxSize;if(b.expression)return f(q,"Could not convert size info: expression not supported"),
!1;if(b.useSymbolValue)return b=m.symbolSize[c],a.minSize[c]=b,a.maxSize[c]=b,a.offset[c]=a.minSize[c],a.factor[c]=0,a.type[c]=1,!0;if(g(b.field)){if(g(b.stops)){if(2===b.stops.length&&e(b.stops[0].size)&&e(b.stops[1].size))return k(b.stops[0].size,b.stops[1].size,b.stops[0].value,b.stops[1].value,a,c),a.type[c]=1,!0;f(q,"Could not convert size info: stops only supported with 2 elements");return!1}if(e(l)&&e(p)&&g(b.minDataValue)&&g(b.maxDataValue))return k(l,p,b.minDataValue,b.maxDataValue,a,c),
a.type[c]=1,!0;if(null!=d.meterIn[b.valueUnit])return a.minSize[c]=-Infinity,a.maxSize[c]=Infinity,a.offset[c]=0,a.factor[c]=1/d.meterIn[b.valueUnit],a.type[c]=1,!0;"unknown"===b.valueUnit?f(q,"Could not convert size info: proportional size not supported"):f(q,"Could not convert size info: scale-dependent size not supported");return!1}if(!g(b.field)){if(b.stops&&b.stops[0]&&e(b.stops[0].size))return a.minSize[c]=b.stops[0].size,a.maxSize[c]=b.stops[0].size,a.offset[c]=a.minSize[c],a.factor[c]=0,a.type[c]=
1,!0;if(e(l))return a.minSize[c]=l,a.maxSize[c]=l,a.offset[c]=l,a.factor[c]=0,a.type[c]=1,!0}f(q,"Could not convert size info: unsupported variant of sizeInfo");return!1}function k(b,a,f,c,e,d){c=0<Math.abs(c-f)?(a-b)/(c-f):0;e.minSize[d]=0<c?b:a;e.maxSize[d]=0<c?a:b;e.offset[d]=b-f*c;e.factor[d]=c}function m(a,c,e,d){if(a.normalizationField||a.valueRepresentation)return f(d,"Could not convert size info: unsupported property"),null;var k=a.field;if(null!=k&&"string"!==typeof k)return f(d,"Could not convert size info: field is not a string"),
null;if(!c.size)c.size={field:a.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[0,0,0]};else if(a.field)if(!c.size.field)c.size.field=a.field;else if(a.field!==c.size.field)return f(d,"Could not convert size info: multiple fields in use"),null;switch(a.axis){case "width":return(k=b(a,c.size,0,e,d))?c:null;case "height":return(k=b(a,c.size,2,e,d))?c:null;case "depth":return(k=b(a,c.size,1,e,d))?c:null;case "width-and-depth":return(k=b(a,c.size,0,e,d))&&b(a,c.size,1,e,d),k?
c:null;case null:case void 0:case "all":return(k=(k=(k=b(a,c.size,0,e,d))&&b(a,c.size,1,e,d))&&b(a,c.size,2,e,d))?c:null;default:return f(d,'Could not convert size info: unknown axis "'+a.axis+'""'),null}}function l(b,a,c){for(var e=0;3>e;++e){var d=a.unitInMeters;1===b.type[e]&&(d*=a.modelSize[e],b.type[e]=2);b.minSize[e]/=d;b.maxSize[e]/=d;b.offset[e]/=d;b.factor[e]/=d}if(0!==b.type[0])a=0;else if(0!==b.type[1])a=1;else if(0!==b.type[2])a=2;else return f(c,"No size axis contains a valid size or scale"),
!1;for(e=0;3>e;++e)0===b.type[e]&&(b.minSize[e]=b.minSize[a],b.maxSize[e]=b.maxSize[a],b.offset[e]=b.offset[a],b.factor[e]=b.factor[a],b.type[e]=b.type[a]);return!0}function t(b,a,f){b[4*a+0]=f.r/255;b[4*a+1]=f.g/255;b[4*a+2]=f.b/255;b[4*a+3]=f.a}function p(b,a,c){if(b.normalizationField)return f(c,"Could not convert color info: unsupported property"),null;if("string"===typeof b.field)if(b.stops){if(8<b.stops.length)return f(c,"Could not convert color info: too many color stops"),null;a.color={field:b.field,
values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};b=b.stops;for(c=0;8>c;++c){var e=b[Math.min(c,b.length-1)];a.color.values[c]=e.value;t(a.color.colors,c,e.color)}}else if(b.colors){if(!g(b.minDataValue)||!g(b.maxDataValue))return f(c,"Could not convert color info: missing data values"),null;if(2!==b.colors.length)return f(c,"Could not convert color info: invalid colors array"),null;a.color={field:b.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};a.color.values[0]=b.minDataValue;t(a.color.colors,0,b.colors[0]);a.color.values[1]=b.maxDataValue;t(a.color.colors,1,b.colors[1]);for(c=2;8>c;++c)a.color.values[c]=b.maxDataValue,t(a.color.colors,c,b.colors[1])}else return f(c,"Could not convert color info: missing stops or colors"),null;else if(b.stops&&0<=b.stops.length||b.colors&&0<=b.colors.length)for(b=b.stops&&0<=b.stops.length?b.stops[0].color:b.colors[0],a.color={field:null,values:[0,
0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},c=0;8>c;c++)a.color.values[c]=Infinity,t(a.color.colors,c,b);else return f(c,"Could not convert color info: no field and no colors/stops"),null;return a}function q(b,a,f,c){b=2===f&&"arithmetic"===b.rotationType;a.offset[f]=b?90:0;a.factor[f]=b?-1:1;a.type[f]=1}function r(b,a,c){if("string"!==typeof b.field)return f(c,"Could not convert rotation info: field is not a string"),null;if(!a.rotation)a.rotation={field:b.field,
offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};else if(b.field)if(!a.rotation.field)a.rotation.field=b.field;else if(b.field!==a.rotation.field)return f(c,"Could not convert rotation info: multiple fields in use"),null;switch(b.axis){case "tilt":return q(b,a.rotation,0,c),a;case "roll":return q(b,a.rotation,1,c),a;case null:case void 0:case "heading":return q(b,a.rotation,2,c),a;default:return f(c,'Could not convert rotation info: unknown axis "'+b.axis+'""'),null}}function u(b,a,c){if(!b)return null;
var e=!a.supportedTypes||!!a.supportedTypes.size,d=!a.supportedTypes||!!a.supportedTypes.color,k=!a.supportedTypes||!!a.supportedTypes.rotation;return(b=b.reduce(function(b,q){if(!b)return b;if(q.valueExpression)return f(c,"Could not convert visual variables: arcade expressions not supported"),null;switch(q.type){case "size":return e?m(q,b,a,c):b;case "color":return d?p(q,b,c):b;case "rotation":return k?r(q,b,c):b;default:return f(c,"Could not convert visual variables: unsupported type "+q.type),
null}},{size:null,color:null,rotation:null}))&&b.size&&!l(b.size,a,c)?null:b}function w(b,a,c){if(!!b!==!!a||b&&b.field!==a.field)return!1;if(b&&"rotation"===c)for(c=0;3>c;c++)if(b.type[c]!==a.type[c]||b.offset[c]!==a.offset[c]||b.factor[c]!==a.factor[c])return!1;return!0}function y(b,a){var c={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvSymbolAnchor:null,vvSymbolRotation:null},
f=b&&null!=b.size;b&&b.size?(c.vvSizeEnabled=!0,c.vvSizeMinSize=b.size.minSize,c.vvSizeMaxSize=b.size.maxSize,c.vvSizeOffset=b.size.offset,c.vvSizeFactor=b.size.factor):b&&f&&(c.vvSizeValue=a.transformation.scale);b&&f&&(c.vvSymbolAnchor=a.transformation.anchor,c.vvSymbolRotation=a.transformation.rotation);b&&b.color&&(c.vvColorEnabled=!0,c.vvColorValues=b.color.values,c.vvColorColors=b.color.colors);return c}Object.defineProperty(h,"__esModule",{value:!0});h.convertVisualVariables=u;h.initFastSymbolUpdatesState=
function(b,a,c){return a&&b&&!b.disableFastUpdates?(b=u(b.visualVariables,c))?{enabled:!0,visualVariables:b,materialParameters:y(b,c),customTransformation:b&&null!=b.size}:{enabled:!1}:{enabled:!1}};h.updateFastSymbolUpdatesState=function(b,a,c){if(!a||!b.enabled)return!1;var f=b.visualVariables;a=u(a.visualVariables,c);if(!(a&&w(f.size,a.size,"size")&&w(f.color,a.color,"color")&&w(f.rotation,a.rotation,"rotation")))return!1;b.visualVariables=a;b.materialParameters=y(a,c);b.customTransformation=a&&
null!=a.size;return!0};h.getMaterialParams=y;var D;(function(b){var f=a.mat4d,e=a.vec3,d=f.create(),k=e.create();b.evaluateModelTransform=function(b,a,e){if(!b.vvSizeEnabled)return e;f.identity(d);f.multiply(e,d,d);c.computeObjectRotation(b.vvSymbolRotation[2],b.vvSymbolRotation[0],b.vvSymbolRotation[1],d);if(b.vvSizeEnabled){for(e=0;3>e;++e){var m=b.vvSizeOffset[e]+a[0]*b.vvSizeFactor[e],q=e;var l=b.vvSizeMinSize[e],g=b.vvSizeMaxSize[e],m=m<l?l:m>g?g:m;k[q]=m}f.scale(d,k,d)}else f.scale(d,b.vvSizeValue,
d);f.translate(d,b.vvSymbolAnchor,d);return d}})(D||(D={}));h.evaluateModelTransform=D.evaluateModelTransform})},"esri/views/3d/layers/graphics/graphicUtils":function(){define(["require","exports","../../../../geometry","../../../../geometry/support/webMercatorUtils","../../lib/glMatrix"],function(n,h,d,a,c){function g(b,c){var f=b.spatialReference;f.equals(c)||(f.isWebMercator&&c.wkid===d.SpatialReference.WGS84.wkid?a.webMercatorToGeographic(b,!1,b):c.isWebMercator&&f.wkid===d.SpatialReference.WGS84.wkid&&
a.geographicToWebMercator(b,!1,b))}function e(b){if(Array.isArray(b)){for(var a=0;a<b.length;a++)if(!e(b[a]))return!1;return!0}return null==b||0<=b}Object.defineProperty(h,"__esModule",{value:!0});var f=c.vec4d,b=c.mat4d,k=[1,1,1];h.computeCentroid=function(b,a){if("extent"===b.type)return b.center;if("polygon"===b.type)return b.centroid;for(var c=0,f=0,e=0,k=b.hasZ,m=0,l=0,h=b.paths;l<h.length;l++){for(var D=h[l],z=0,J=D;z<J.length;z++){var A=J[z],c=c+A[0],f=f+A[1];k&&(e+=A[2])}m+=D.length}b=new d.Point({x:c/
m,y:f/m,z:k?e/m:void 0,spatialReference:b.spatialReference});a&&g(b,a);return b};h.convertToSR=g;h.enlargeExtent=function(b,a,c){if(b){a||(a=f.create());var e=.5*b.width*(c-1);c=.5*b.height*(c-1);b.width<1E-7*b.height?e+=c/20:b.height<1E-7*b.width&&(c+=e/20);f.set4(b.xmin-e,b.ymin-c,b.xmax+e,b.ymax+c,a);return a}return null};h.updateVertexAttributeAuxpos1w=function(b,a){for(var c=0;c<b.geometries.length;++c){var f=b.geometries[c].data.vertexAttributes.auxpos1;f&&f.data[3]!==a&&(f.data[3]=a,b.geometryVertexAttrsUpdated(c))}};
h.mixinColorAndOpacity=function(b,a){var c=[1,1,1,1];null!=b&&(c[0]=b[0],c[1]=b[1],c[2]=b[2]);null!==a&&void 0!==a?c[3]=a:null!=b&&3<b.length&&(c[3]=b[3]);return c};h.overrideColor=function(b,a,c,f,e){e=[e[0],e[1],e[2],e[3]];for(var d=0;3>d;++d)b&&null!=b[d]?e[d]=b[d]:c&&null!=c[d]&&(e[d]=c[d]);null!=a?e[3]=a:null!=f&&(e[3]=f);return e};h.computeObjectScale=function(b,a,c,f){void 0===b&&(b=k);void 0===f&&(f=1);var e=Array(3);if(null==a||null==c)e[0]=1,e[1]=1,e[2]=1;else{for(var d=void 0,m=0,g=2;0<=
g;g--){var l=b[g],p=void 0,t=null!=l,h=0===g&&!d&&!t,A=c[g];"symbolValue"===l||h?p=0!==A?a[g]/A:1:t&&"proportional"!==l&&isFinite(l)&&(p=0!==A?l/A:1);null!=p&&(d=e[g]=p,m=Math.max(m,Math.abs(p)))}for(g=2;0<=g;g--)null==e[g]?e[g]=d:0===e[g]&&(e[g]=.001*m)}for(g=2;0<=g;g--)e[g]/=f;return e};h.computeSizeWithResourceSize=function(b,a){var c=a.width,f=a.depth,e=a.height;a=a.isPrimitive?10:1;if(null==c&&null==e&&null==f)return[a*b[0],a*b[1],a*b[2]];for(var c=[c,f,e],d,f=0;3>f;f++)if(e=c[f],null!=e){d=
e/b[f];break}for(f=0;3>f;f++)null==c[f]&&(c[f]=b[f]*d);return c};h.validateSymbolLayerSize=function(b){null!=b.isPrimitive&&(b=[b.width,b.depth,b.height]);return e(b)?null:"Symbol sizes may not be negative values"};h.computeObjectRotation=function(a,c,f,e){void 0===e&&(e=b.identity());a=a||0;c=c||0;f=f||0;0!==a&&b.rotateZ(e,-a/180*Math.PI,e);0!==c&&b.rotateX(e,c/180*Math.PI,e);0!==f&&b.rotateY(e,f/180*Math.PI,e);return e}})},"esri/views/2d/engine/webgl/TileHandler":function(){define("require exports module ../../../../core/Error ../../../../core/promiseUtils ../../../../core/promiseUtils ../../../../core/kebabDictionary ../../../../core/workers/workers ../../../../core/requireUtils ../../../../tasks/QueryTask ../../../../tasks/support/Query ./TileData".split(" "),
function(n,h,d,a,c,g,e,f,b,k,m,l){var t=e({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});return function(){function e(b,a,c,f,e,d){this._parent=b;this._tilecoordRange=f;this._tileCoordRatio=e;this._quantizationFactor=d;this._wglFeatureView=a}e.prototype.start=function(){var a=this;return f.open(this,b.getAbsMid("./WorkerTileHandler",n,d),!0).then(function(b){a._connection=b})};e.prototype.configure=
function(b,a){var c=this._parent.layer;this._queryTask=new k(c.parsedUrl.path);this._returnCentroid=this._getReturnCentroid(c.renderer);var f=c.createQuery();return this._connection.invoke("configure",{renderer:b.toJSON(),spatialReference:this._parent.view.spatialReference.toJSON(),capabilities:c.capabilities,url:c.parsedUrl.path,geometryType:t.toJSON(c.geometryType),query:f.toJSON(),outFields:f.outFields,objectIdField:c.objectIdField,tileCoordRange:this._tilecoordRange,tileCoordRatio:this._tileCoordRatio,
returnCentroid:this._returnCentroid,quantizationFactor:this._quantizationFactor,pixelRatio:window.devicePixelRatio||1,processing:a&&a.toWorker()||null,queryInMainThread:!0})};e.prototype.stop=function(){this._connection&&(this._connection.close(),this._connection=null)};e.prototype.registerTile=function(b){return this._connection.invoke("registerTile",{key:b.id}).then(function(b){return b&&b.displayData&&b.bufferData?l.deserialize(b):null})};e.prototype.removeTile=function(b){this._connection.invoke("unregisterTile",
{key:b.id})};e.prototype.getFeatures=function(b){return this._connection.invoke("getFeatures",{featureIds:b})};e.prototype.getMaterialItems=function(b){(b=b.items)&&0!==b.length||c.resolve({data:{items:[]},buffers:[]});var a=this._wglFeatureView.textureManager,f=[];b.forEach(function(b){f.push(a.rasterizeItem(b.symbol,b.glyphIds))});return g.all(f).then(function(b){return{data:{items:b.map(function(b,a){return{id:a,mosaicItem:b}})},buffers:[]}})};e.prototype.executeProcessing=function(b){var f=this;
return c.resolve().then(function(){var e=f._parent.layer.processing;return e?(e=e.process(JSON.parse(b.featureSet),m.fromJSON(b.query),e.options))?e:c.reject(new a("FeatureLayer","invalid processing.process() method, returns nothing")):c.resolve({data:b.featureSet})}).then(function(b){return{data:{featureSet:JSON.stringify(b)},buffers:[]}})};e.prototype.queryFeatures=function(b){var f=this,e=m.fromJSON(b.query);b=this._queryTask;var d=this._parent.layer,k=d.source&&"esri.layers.graphics.sources.CSVSource"===
d.source.declaredClass;e.returnGeometry=!this._returnCentroid||d.renderer.backgroundFillSymbol;e.returnJSON=!0;e.returnCentroid=this._returnCentroid;return(k?d.source.queryFeaturesJSON(e):b.rawExecute(e).then(function(b){return b.data})).then(function(b){var d=f._parent.layer.processing;return d?(b=d.process(b,e,d.options))?b:c.reject(new a("FeatureLayer","invalid processing.process() method, returns nothing")):b}).then(function(b){return{data:{featureSet:JSON.stringify(b)},buffers:[]}})};e.prototype._getReturnCentroid=
function(b){function a(b){if(!b)return!1;b=b.type;return"simple-marker"===b||"picture-marker"===b||"text"===b}if("polygon"!==this._parent.layer.geometryType)return!1;switch(b.type){case "simple":return a(b.symbol);case "unique-value":return a(b.defaultSymbol)||b.uniqueValueInfos.some(function(b){return a(b.symbol)});case "class-breaks":return a(b.defaultSymbol)||b.classBreakInfos.some(function(b){return a(b.symbol)});default:return!0}};return e}()})},"esri/views/2d/engine/webgl/TileData":function(){define("require exports ../../../../core/ObjectPool ./TileDisplayData ./TileBufferData ./WGLDisplayRecord ./enums".split(" "),
function(n,h,d,a,c,g,e){return function(){function f(){this.tileBufferData=this.tileDisplayData=null}f.prototype.release=function(){a.pool.release(this.tileDisplayData);this.tileDisplayData=null;c.pool.release(this.tileBufferData);this.tileBufferData=null};f.prototype.serialize=function(){var b=this.tileBufferData.serialize(),c=this.tileBufferData.getBuffers(),f=a.serialize(this.tileDisplayData,null,0),f=new Uint8Array(f);a.serialize(this.tileDisplayData,f,0);c.push(f.buffer);return{data:{displayData:f.buffer,
bufferData:b},buffers:c}};f.deserialize=function(b){var e=a.pool.acquire();a.deserialize(e,new Uint8Array(b.displayData),0);b=c.deserialize(b.bufferData);var d=new f;d.tileDisplayData=e;d.tileBufferData=b;return d};f.prototype.deserializeMeshData=function(){var b=this;this.tileDisplayData.displayObjectRegistry.forEach(function(a,c){a=0;for(c=b.tileDisplayData.displayObjectRegistry.get(c).displayRecords;a<c.length;a++){var f=c[a],e=f.geometryType;f.readMeshDataFromBuffers(b.tileBufferData.geometries[e].vertexBuffer,
b.tileBufferData.geometries[e].indexBuffer)}})};f.bind=function(b,a){var c=new f;c.tileDisplayData=b;c.tileBufferData=a;return c};f.create=function(b,d){var k=new f;k.tileDisplayData=new a;for(var l=[0,0,0,0],t=[0,0,0,0],p=0;p<b.length;p++){var q=b[p];k.tileDisplayData.displayObjects.push(q);k.tileDisplayData.displayObjectRegistry.set(q.id,q);for(var r=0,q=q.displayRecords;r<q.length;r++){var u=q[r];k.tileDisplayData.displayRecords[u.geometryType].push(u);l[u.geometryType]+=u.meshData.vertexCount;
t[u.geometryType]+=u.meshData.indexData.length}}p=function(b,a){return b.sortKey-a.sortKey};for(b=0;b<k.tileDisplayData.displayRecords.length;b++)k.tileDisplayData.displayRecords[b].sort(p);d=[d.fill||{},d.line||{},d.icon||{},d.text||{}];p=new c;for(b=0;4>b;b++){p.geometries[b].indexBuffer=new Uint32Array(t[b]);p.geometries[b].vertexBuffer={};var r=d[b],h;for(h in r)p.geometries[b].vertexBuffer[h]={data:new Uint32Array(l[b]*r[h]/4),stride:r[h]}}k.tileBufferData=p;(l=k.tileBufferData.geometries[e.WGLGeometryType.FILL])&&
g.writeAllMeshDataToBuffers(k.tileDisplayData.displayRecords[e.WGLGeometryType.FILL],l.vertexBuffer,l.indexBuffer);(l=k.tileBufferData.geometries[e.WGLGeometryType.LINE])&&g.writeAllMeshDataToBuffers(k.tileDisplayData.displayRecords[e.WGLGeometryType.LINE],l.vertexBuffer,l.indexBuffer);(l=k.tileBufferData.geometries[e.WGLGeometryType.MARKER])&&g.writeAllMeshDataToBuffers(k.tileDisplayData.displayRecords[e.WGLGeometryType.MARKER],l.vertexBuffer,l.indexBuffer);(l=k.tileBufferData.geometries[e.WGLGeometryType.TEXT])&&
g.writeAllMeshDataToBuffers(k.tileDisplayData.displayRecords[e.WGLGeometryType.TEXT],l.vertexBuffer,l.indexBuffer);k.tileDisplayData.displayList.addToList(k.tileDisplayData.displayRecords[e.WGLGeometryType.FILL]);k.tileDisplayData.displayList.addToList(k.tileDisplayData.displayRecords[e.WGLGeometryType.LINE]);k.tileDisplayData.displayList.addToList(k.tileDisplayData.displayRecords[e.WGLGeometryType.MARKER]);k.tileDisplayData.displayList.addToList(k.tileDisplayData.displayRecords[e.WGLGeometryType.TEXT]);
return k};f.pool=new d(f);return f}()})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define("require exports ../../../../core/ObjectPool ./WGLDisplayObject ./WGLDisplayRecord ./WGLDisplayList ./enums ./Utils".split(" "),function(n,h,d,a,c,g,e,f){function b(b,a,e,d){b=b[a];a=0;a+=f.serializeInteger(b.length,e,d+a);for(var k=0;k<b.length;k++)a+=c.serialize(b[k],e,d+a,!1);return a}function k(b,a,e,d){b=b[a];var k=0,k=k+f.deserializeInteger(m,e,d+k);b.length=m.n;for(var g=0;g<m.n;++g)k+=c.deserialize(l,
e,d+k,!1),b[g]=l.displayRecord,b[g].geometryType=a;return k}var m={n:void 0},l={displayRecord:null},t={n:void 0},p={n:void 0},q={n:void 0};return function(){function c(){this.displayList=new g;this.displayRecords=[[],[],[],[]];this.displayObjects=[];this.displayObjectRegistry=new Map}c.prototype.release=function(){};c.serialize=function(a,c,d){var k=a.displayRecords,m=a.displayObjects,l=0,l=l+g.serialize(a.displayList,c,d+l),l=l+b(k,e.WGLGeometryType.FILL,c,d+l),l=l+b(k,e.WGLGeometryType.LINE,c,d+
l),l=l+b(k,e.WGLGeometryType.MARKER,c,d+l);a=l+=b(k,e.WGLGeometryType.TEXT,c,d+l);d+=l;for(var l=0,l=l+f.serializeInteger(m.length,c,d+l),q=new Map,p=0,t=k.length;p<t;p++)for(var u=k[p],r=0,h=u.length;r<h;r++)q.set(u[r],r);p=0;for(t=m.length;p<t;p++)for(k=m[p],u=k.displayRecords,l+=f.serializeInteger(k.id,c,d+l),l+=f.serializeInteger(u.length,c,d+l),r=0,h=u.length;r<h;r++)k=u[r],q.has(k)&&(c&&(c[d+l]=k.geometryType),++l,l+=f.serializeInteger(q.get(k),c,d+l));return a+l};c.deserialize=function(b,c,
d){var l=0;b.displayList=g.pool.acquire();var l=l+g.deserialize(b.displayList,c,d+l),l=l+k(b.displayRecords,e.WGLGeometryType.FILL,c,d+l),l=l+k(b.displayRecords,e.WGLGeometryType.LINE,c,d+l),l=l+k(b.displayRecords,e.WGLGeometryType.MARKER,c,d+l),m=l+=k(b.displayRecords,e.WGLGeometryType.TEXT,c,d+l);d+=l;var l=b.displayObjects,u=b.displayObjectRegistry;b=b.displayRecords;var r=0;u.clear();for(var h={n:void 0},r=r+f.deserializeInteger(h,c,d+r),w=0;w<h.n;++w){var r=r+f.deserializeInteger(t,c,d+r),r=
r+f.deserializeInteger(p,c,d+r),y=a.pool.acquire();l.push(y);y.id=t.n;for(var n=0;n<p.n;++n){var C=void 0;r&&(C=c[d+r]);++r;r+=f.deserializeInteger(q,c,d+r);C=b[C][q.n];C.id=y.id;y.displayRecords[n]=C}u.set(y.id,y)}return m+r};c.pool=new d(c);return c}()})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["require","exports","../../../../core/ObjectPool","./WGLDisplayRecord","./Utils"],function(n,h,d,a,c){return function(){function g(){this.displayRecords=[]}g.prototype.acquire=function(a){this.id=
a};g.prototype.release=function(){this.id=void 0;this.displayRecords.length=0};g.serialize=function(e,f,b){var d=0,d=d+c.serializeInteger(e.id,f,b+d),d=d+c.serializeInteger(e.displayRecords.length,f,b+d),g=0;for(e=e.displayRecords;g<e.length;g++)d+=a.serialize(e[g],f,b+d,!0);return d};g.deserialize=function(e,f,b){var d=0,m={n:0},d=d+c.deserializeInteger(m,f,b+d),l={n:0},d=d+c.deserializeInteger(l,f,b+d),t={displayRecord:void 0};e.displayObject=g.pool.acquire();e.displayObject.id=m.n;e.displayObject.displayRecords.length=
l.n;for(var p=0;p<l.n;++p)d+=a.deserialize(t,f,b+d,!0),e.displayObject.displayRecords[p]=t.displayRecord,e.displayObject.displayRecords[p].id=m.n;return d};g.pool=new d(g);return g}()})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define("require exports ../../../../core/ObjectPool ./MeshData ./MaterialInfo ./enums ./Utils".split(" "),function(n,h,d,a,c,g,e){return function(){function f(){this.id=-1;this.geometryType=g.WGLGeometryType.UNKNOWN;this.materialInfo=this.meshData=null;this.sortKey=
this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}f.prototype.acquire=function(b,a,c,f,e,d){this.setData(b,a,c,f,e,d)};f.prototype.release=function(){this.id=-1;this.geometryType=g.WGLGeometryType.UNKNOWN;this.materialInfo=this.meshData=null;this.sortKey=this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0};f.prototype.setData=function(b,a,c,f,e,d){this.id=b;this.geometryType=a;this.meshData=c;this.materialInfo=
f;this.symbolLevel=e;this.zOrder=d;this._computeSortKey()};f.prototype.readMeshDataFromBuffers=function(b,c){this.meshData?this.meshData.clear():this.meshData=a.pool.acquire();for(var f in b){for(var e=b[f].stride,d=b[f].data,k=[],g=0;g<e*this.vertexCount/4;++g)k[g]=d[g+e*this.vertexFrom/4];this.meshData.vertexData.set(f,k)}for(g=this.meshData.indexData.length=0;g<this.indexCount;++g)this.meshData.indexData[g]=c[g+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount};f.prototype.writeMeshDataToBuffers=
function(b,a,c,f){for(var e in a)for(var d=a[e].stride,k=this.meshData.vertexData.get(e),g=a[e].data,l=0;l<d*this.meshData.vertexCount/4;++l)g[l+d*b/4]=k[l];for(l=0;l<this.meshData.indexData.length;++l)f[l+c]=this.meshData.indexData[l]+b;this.vertexFrom=b;this.vertexCount=this.meshData.vertexCount;this.indexFrom=c;this.indexCount=this.meshData.indexData.length};f.writeAllMeshDataToBuffers=function(b,a,c){for(var f=0,e=0,d=0;d<b.length;d++){var k=b[d];k.writeMeshDataToBuffers(f,a,e,c);f+=k.vertexCount;
e+=k.indexCount}};f.prototype._computeSortKey=function(){this.sortKey=(this.symbolLevel&31)<<12|(this.zOrder&127)<<4|this.geometryType&7};f.serialize=function(b,a,f,d){var k=0;d&&(a&&(a[f+k]=b.geometryType),++k);k+=c.serialize(b.materialInfo,a,f+k);a&&(a[f+k]=b.symbolLevel);++k;a&&(a[f+k]=b.zOrder);++k;k+=e.serializeInteger(b.vertexFrom,a,f+k);k+=e.serializeInteger(b.vertexCount,a,f+k);k+=e.serializeInteger(b.indexFrom,a,f+k);return k+=e.serializeInteger(b.indexCount,a,f+k)};f.deserialize=function(b,
a,d,g){var k=0;b.displayRecord=f.pool.acquire();b.displayRecord.id=-1;g&&(b.displayRecord.geometryType=a[d+k],++k);b.displayRecord.meshData=null;g={materialInfo:null};k+=c.deserialize(g,a,d+k);b.displayRecord.materialInfo=g.materialInfo;b.displayRecord.symbolLevel=a[d+k];++k;b.displayRecord.zOrder=a[d+k];++k;g={n:void 0};k+=e.deserializeInteger(g,a,d+k);b.displayRecord.vertexFrom=g.n;k+=e.deserializeInteger(g,a,d+k);b.displayRecord.vertexCount=g.n;k+=e.deserializeInteger(g,a,d+k);b.displayRecord.indexFrom=
g.n;k+=e.deserializeInteger(g,a,d+k);b.displayRecord.indexCount=g.n;b.displayRecord._computeSortKey();return k};f.pool=new d(f);return f}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(["require","exports","../../../../core/ObjectPool"],function(n,h,d){return function(){function a(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}a.prototype.release=function(){this.clear()};a.prototype.clear=function(){this.vertexData.clear();this.vertexCount=0;this.indexData=[]};a.prototype.update=
function(a,d,e){for(var c in a)this.vertexData.set(c,a[c]);for(c in this.vertexData)null===a[c]&&this.vertexData.delete(c);this.vertexCount=d;this.indexData=e};a.pool=new d(a);return a}()})},"esri/views/2d/engine/webgl/WGLDisplayList":function(){define("require exports ../../../../core/ObjectPool ./enums ./MaterialInfo ./Utils".split(" "),function(n,h,d,a,c,g){n=function(){function m(){this.symbolLevels=[]}m.prototype.release=function(){this.symbolLevels.forEach(function(b){k.pool.release(b)});this.symbolLevels.length=
0};Object.defineProperty(m.prototype,"empty",{get:function(){return!this.symbolLevels||0===this.symbolLevels.length},enumerable:!0,configurable:!0});m.prototype.addToList=function(b){var a=this;b.forEach(function(b){a._addToList(b)})};m.prototype.removeFromList=function(b){var a=this;b.forEach(function(b){a._removeFromList(b)})};m.prototype._addToList=function(b){var a=this._getDisplayList(b.symbolLevel,b.zOrder,b.geometryType),c=0<a.length?a[a.length-1]:null;null!==c&&g.isSameMaterialInfo(c.materialInfo,
b.materialInfo)&&c.indexFrom+c.indexCount===b.indexFrom?c.indexCount+=b.indexCount:(c=e.pool.acquire(),c.indexFrom=b.indexFrom,c.indexCount=b.indexCount,c.materialInfo=b.materialInfo,c.geometryType=b.geometryType,a.push(c))};m.prototype._removeFromList=function(b){for(var a=this._getDisplayList(b.symbolLevel,b.zOrder,b.geometryType),f=a.length,d=void 0,k=0;k<f;++k){var g=a[k];b.indexFrom+b.indexCount>g.indexFrom&&b.indexFrom<g.indexFrom+g.indexCount&&(d=k)}if(void 0!==d)if(g=a[d],b.indexFrom<g.indexFrom)g.indexCount-=
b.indexCount,g.indexFrom+=b.indexCount;else if(b.indexFrom+b.indexCount>g.indexFrom+g.indexCount)g.indexCount-=b.indexCount;else{var f=g.indexFrom,k=b.indexFrom-g.indexFrom,l=b.indexCount;b=g.indexFrom+g.indexCount-(b.indexFrom+b.indexCount);g.indexCount=k;var m=e.pool.acquire();m.geometryType=g.geometryType;m.materialInfo=c.pool.acquire();m.materialInfo.copy(g.materialInfo);m.indexFrom=f+k+l;m.indexCount=b;a.splice(d+1,0,m)}};m.prototype._getDisplayList=function(c,e,d){for(var g,l=this.symbolLevels.length,
m=0;m<l;m++)if(this.symbolLevels[m].symbolLevel===c){g=this.symbolLevels[m];break}g||(g=k.pool.acquire(),g.symbolLevel=c,this.symbolLevels.push(g));var p;c=g.zLevels.length;for(l=0;l<c;l++)if(g.zLevels[l].zLevel===e){p=g.zLevels[l];break}p||(p=b.pool.acquire(),p.geometryDPInfo=f.pool.acquire(),p.zLevel=e,g.zLevels.push(p));var h;switch(d){case a.WGLGeometryType.FILL:p.geometryDPInfo.fill||(p.geometryDPInfo.fill=[]);h=p.geometryDPInfo.fill;break;case a.WGLGeometryType.LINE:p.geometryDPInfo.line||(p.geometryDPInfo.line=
[]);h=p.geometryDPInfo.line;break;case a.WGLGeometryType.MARKER:p.geometryDPInfo.marker||(p.geometryDPInfo.marker=[]);h=p.geometryDPInfo.marker;break;case a.WGLGeometryType.TEXT:p.geometryDPInfo.text||(p.geometryDPInfo.text=[]);h=p.geometryDPInfo.text;break;default:console.error("Trying to add a record with geometry type '"+d+"'.")}return h};m.serialize=function(b,a,c){var f=0;a&&(a[c+f]=b.symbolLevels.length);++f;var e=0;for(b=b.symbolLevels;e<b.length;e++){var d=b[e];a&&(a[c+f]=d.symbolLevel);++f;
a&&(a[c+f]=d.zLevels.length);++f;for(var k=0,d=d.zLevels;k<d.length;k++){var g=d[k];a&&(a[c+f]=g.zLevel);++f;g=g.geometryDPInfo;f+=this._serializeDisplayListInfo(g.fill,a,c+f);f+=this._serializeDisplayListInfo(g.line,a,c+f);f+=this._serializeDisplayListInfo(g.marker,a,c+f);f+=this._serializeDisplayListInfo(g.text,a,c+f)}}return f};m.deserialize=function(c,f,e){var d=0,g=f[e+d];++d;for(var l=0;l<g;++l){var m=k.pool.acquire();m.symbolLevel=f[e+d];++d;c.symbolLevels.push(m);var p=f[e+d];++d;for(var h=
0;h<p;++h){var t=b.pool.acquire();t.zLevel=f[e+d];++d;m.zLevels.push(t);var n=[],d=d+this._deserializeDisplayListInfo(n,a.WGLGeometryType.FILL,f,e+d);t.geometryDPInfo.fill=0<n.length?n:null;n=[];d+=this._deserializeDisplayListInfo(n,a.WGLGeometryType.LINE,f,e+d);t.geometryDPInfo.line=0<n.length?n:null;n=[];d+=this._deserializeDisplayListInfo(n,a.WGLGeometryType.MARKER,f,e+d);t.geometryDPInfo.marker=0<n.length?n:null;n=[];d+=this._deserializeDisplayListInfo(n,a.WGLGeometryType.TEXT,f,e+d);t.geometryDPInfo.text=
0<n.length?n:null}}return d};m._serializeDisplayListInfo=function(b,a,f){var e=0;if(b)for(var e=e+g.serializeInteger(b.length,a,f+e),d=0;d<b.length;d++)var k=b[d],e=e+c.serialize(k.materialInfo,a,f+e),e=e+g.serializeInteger(k.indexFrom,a,f+e),e=e+g.serializeInteger(k.indexCount,a,f+e);else a&&(a[f+e]=0),++e;return e};m._deserializeDisplayListInfo=function(b,a,f,d){var k={n:void 0},m=0,m=m+g.deserializeInteger(k,f,d+m),l=k.n;b.length=l;for(var p=0;p<l;++p){var q=e.pool.acquire();q.geometryType=a;var h=
{materialInfo:null},m=m+c.deserialize(h,f,d+m);q.materialInfo=h.materialInfo;m+=g.deserializeInteger(k,f,d+m);q.indexFrom=k.n;m+=g.deserializeInteger(k,f,d+m);q.indexCount=k.n;b[p]=q}return m};m.pool=new d(m);return m}();var e=function(){function b(){this.materialInfo=null;this.indexCount=this.indexFrom=0}b.prototype.release=function(){this.geometryType=a.WGLGeometryType.UNKNOWN;this.materialInfo=null;this.indexCount=this.indexFrom=0};b.pool=new d(b);return b}(),f=function(){function b(){this.text=
this.marker=this.line=this.fill=null}b.prototype.release=function(){this.fill&&(this.fill.forEach(function(b){return e.pool.release(b)}),this.fill.length=0);this.line&&(this.line.forEach(function(b){return e.pool.release(b)}),this.line.length=0);this.marker&&(this.marker.forEach(function(b){return e.pool.release(b)}),this.marker.length=0);this.text&&(this.text.forEach(function(b){return e.pool.release(b)}),this.text.length=0)};b.pool=new d(b);return b}(),b=function(){function b(){}b.prototype.acquire=
function(){this.geometryDPInfo=f.pool.acquire()};b.prototype.release=function(){this.zLevel=null;f.pool.release(this.geometryDPInfo);this.geometryDPInfo=null};b.pool=new d(b);return b}(),k=function(){function a(){this.zLevels=[]}a.prototype.release=function(){this.symbolLevel=null;this.zLevels.forEach(function(a){return b.pool.release(a)});this.zLevels.length=0};a.pool=new d(a);return a}();return n})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["require","exports","../../../../core/ObjectPool"],
function(n,h,d){return function(){function a(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}a.prototype.release=function(){};a.deserialize=function(c){for(var d=a.pool.acquire(),e=0;4>e;++e){d.geometries[e].indexBuffer=new Uint32Array(c.geometries[e].indexBuffer);d.geometries[e].vertexBuffer={};for(var f in c.geometries[e].vertexBuffer)d.geometries[e].vertexBuffer[f]={data:new Uint32Array(c.geometries[e].vertexBuffer[f].data),
stride:c.geometries[e].vertexBuffer[f].stride}}return d};a.prototype.serialize=function(){for(var a={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}}]},d=0;4>d;++d)for(var e in this.geometries[d].vertexBuffer)a.geometries[d].vertexBuffer[e]={data:this.geometries[d].vertexBuffer[e].data.buffer,
stride:this.geometries[d].vertexBuffer[e].stride};return a};a.prototype.getBuffers=function(){for(var a=[],d=0;4>d;++d){a.push(this.geometries[d].indexBuffer.buffer);for(var e in this.geometries[d].vertexBuffer)a.push(this.geometries[d].vertexBuffer[e].data.buffer)}return a};a.pool=new d(a);return a}()})},"esri/views/2d/engine/webgl/WGLTile":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/ObjectPool ../../../../core/libs/gl-matrix/vec2 ../../../../core/libs/gl-matrix/mat4 ../../tiling/TileKey ../DisplayObject ./WGLDisplayRecord ./WGLGeometry ./enums ./Utils ./WGLDisplayList".split(" "),
function(n,h,d,a,c,g,e,f,b,k,m,l,t){return function(f){function q(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];a=f.call(this)||this;a.displayList=null;a.hlDisplayList=null;a.displayObjectRegistry=new Map;a.iconDisplayRecords=null;a.textDisplayRecords=null;a.lineDisplayRecords=null;a.fillDisplayRecords=null;a.iconGeometry=null;a.textGeometry=null;a.lineGeometry=null;a.fillGeometry=null;a.coords=[0,0];a.bounds=[0,0,0,0];a.tileTransform={transform:Float32Array[16],displayCoord:Float32Array[2]};
a._hasVisualVariables=!1;0<b.length&&(d=a.acquire).call.apply(d,[a].concat(b));a.tileTransform.transform=g.create();a.tileTransform.displayCoord=c.create();return a;var d}d(q,f);q.prototype.acquire=function(b,a,c,f,d){this.key=e.pool.acquire(b);this.coords[0]=a[0];this.coords[1]=a[3];this.bounds=a;this.coordRange=c;this.width=f;this.height=d};q.prototype.release=function(){this.clear();e.pool.release(this.key);this.key=null};Object.defineProperty(q.prototype,"canDisplay",{get:function(){return!!this.attached&&
!!this.displayList},enumerable:!0,configurable:!0});q.prototype.setData=function(b,a,c){b&&b.tileDisplayData&&(this._hasVisualVariables=a,this.displayList&&b.tileDisplayData.displayList!==this.displayList&&t.pool.release(this.displayList),this.displayList=b.tileDisplayData.displayList,this.fillDisplayRecords=b.tileDisplayData.displayRecords[m.WGLGeometryType.FILL],this.lineDisplayRecords=b.tileDisplayData.displayRecords[m.WGLGeometryType.LINE],this.iconDisplayRecords=b.tileDisplayData.displayRecords[m.WGLGeometryType.MARKER],
this.textDisplayRecords=b.tileDisplayData.displayRecords[m.WGLGeometryType.TEXT],this.displayObjectRegistry=b.tileDisplayData.displayObjectRegistry,this.fillDisplayRecords&&0<this.fillDisplayRecords.length&&(this.fillGeometry=new k,this.fillGeometry.initializeWithBuffers(this._hasVisualVariables?l.C_FILL_VERTEX_DEF_VV:l.C_FILL_VERTEX_DEF,b.tileBufferData.geometries[m.WGLGeometryType.FILL],35044)),this.lineDisplayRecords&&0<this.lineDisplayRecords.length&&(this.lineGeometry=new k,this.lineGeometry.initializeWithBuffers(this._hasVisualVariables?
l.C_LINE_VERTEX_DEF_VV:l.C_LINE_VERTEX_DEF,b.tileBufferData.geometries[m.WGLGeometryType.LINE],35044)),this.iconDisplayRecords&&0<this.iconDisplayRecords.length&&(this.iconGeometry=new k,this.iconGeometry.initializeWithBuffers(this._hasVisualVariables?l.C_ICON_VERTEX_DEF_VV:l.C_ICON_VERTEX_DEF,b.tileBufferData.geometries[m.WGLGeometryType.MARKER],35044)),this.textDisplayRecords&&0<this.textDisplayRecords.length&&(this.textGeometry=new k,this.textGeometry.initializeWithBuffers(this._hasVisualVariables?
l.C_TEXT_VERTEX_DEF_VV:l.C_TEXT_VERTEX_DEF,b.tileBufferData.geometries[m.WGLGeometryType.TEXT],35044)))};q.prototype.appendData=function(b){};q.prototype.updateObjects=function(b){var a=(b.remove||[]).slice();b=b.update||[];for(var c=[],f=[],d=[],e=[],g=[],q=0;q<b.length;q++){var p=b[q];this.displayObjectRegistry.get(p.id)&&a.push(p.id)}for(var h=0;h<a.length;h++){var r=a[h];if(p=this.displayObjectRegistry.get(r)){for(var n=0,p=p.displayRecords;n<p.length;n++)switch(q=p[n],c.push(q),q.geometryType){case m.WGLGeometryType.FILL:f.push(q);
break;case m.WGLGeometryType.LINE:d.push(q);break;case m.WGLGeometryType.MARKER:e.push(q);break;case m.WGLGeometryType.TEXT:g.push(q)}this.displayObjectRegistry.delete(r)}}this.displayList||(this.displayList=t.pool.acquire());(p=this.displayList)&&p.removeFromList(c);this._removeRecords(this.fillGeometry,this.fillDisplayRecords,f);this._removeRecords(this.lineGeometry,this.lineDisplayRecords,d);this._removeRecords(this.iconGeometry,this.iconDisplayRecords,e);this._removeRecords(this.textGeometry,
this.textDisplayRecords,g);a=[];for(c=0;c<b.length;c++){p=b[c];f=0;for(d=p.displayRecords;f<d.length;f++)switch(q=d[f],a.push(q),q.geometryType){case m.WGLGeometryType.FILL:this.fillDisplayRecords=this.fillDisplayRecords||[];this.fillDisplayRecords.push(q);break;case m.WGLGeometryType.LINE:this.lineDisplayRecords=this.lineDisplayRecords||[];this.lineDisplayRecords.push(q);break;case m.WGLGeometryType.MARKER:this.iconDisplayRecords=this.iconDisplayRecords||[];this.iconDisplayRecords.push(q);break;
case m.WGLGeometryType.TEXT:this.textDisplayRecords=this.textDisplayRecords||[],this.textDisplayRecords.push(q)}this.displayObjectRegistry.set(p.id,p)}b=!1;this.fillGeometry||(this.fillGeometry=new k);this.lineGeometry||(this.lineGeometry=new k);this.iconGeometry||(this.iconGeometry=new k);b=b||this._updateRecords(this.iconGeometry,this.iconDisplayRecords,this._hasVisualVariables?l.C_ICON_VERTEX_DEF_VV:l.C_ICON_VERTEX_DEF);this.textGeometry||(this.textGeometry=new k);b?(this.displayList&&t.pool.release(this.displayList),
b=t.pool.acquire(),b.addToList(this.fillDisplayRecords),b.addToList(this.lineDisplayRecords),b.addToList(this.iconDisplayRecords),b.addToList(this.textDisplayRecords),this.displayList=b):(b=this.displayList)?b.addToList(a):(b=t.pool.acquire(),b.addToList(a),this.displayList=b)};q.prototype._updateRecords=function(b,a,c){if(b.update(a)===m.WGLGeometryTransactionStatus.FAILED_OUT_OF_MEMORY)return b.initializeWithRecords(c,a,35044),this.attached=!1,!0;b.invalidateIndexBuffer();b.invalidateVertexBuffers();
return!1};q.prototype._removeRecords=function(b,a,c){if(b){this.iconGeometry.remove(c);for(var f=b=a.length,d=0;d<b;++d){for(var e=void 0,e=0;e<f&&a[d]!==c[e];++e);e<c.length&&(a.splice(d,1),d--)}}};q.prototype.clear=function(){this.iconGeometry&&(this.iconGeometry.clear(),this.iconGeometry=null);this.textGeometry&&(this.textGeometry.clear(),this.textGeometry=null);this.lineGeometry&&(this.lineGeometry.clear(),this.lineGeometry=null);this.fillGeometry&&(this.fillGeometry.clear(),this.fillGeometry=
null);this.displayObjectRegistry.clear();this.displayList&&(t.pool.release(this.displayList),this.displayList=null);this.hlDisplayList&&(t.pool.release(this.hlDisplayList),this.hlDisplayList=null);this.iconDisplayRecords&&(this.iconDisplayRecords.length=0);this.textDisplayRecords&&(this.textDisplayRecords.length=0);this.lineDisplayRecords&&(this.lineDisplayRecords.length=0);this.fillDisplayRecords&&(this.fillDisplayRecords.length=0)};q.prototype.dispose=function(){this.release()};q.prototype.attach=
function(b){var a=!0;this.fillGeometry&&(this.fillGeometry.attached||(a=a&&this.fillGeometry.attach(b)));this.lineGeometry&&(this.lineGeometry.attached||(a=a&&this.lineGeometry.attach(b)));this.iconGeometry&&(this.iconGeometry.attached||(a=a&&this.iconGeometry.attach(b)));this.textGeometry&&(this.textGeometry.attached||(a=a&&this.textGeometry.attach(b)));return a};q.prototype.detach=function(b){};q.prototype.doRender=function(b){};q.prototype.buildHLList=function(a){var c=this;this.hlDisplayList&&
t.pool.release(this.hlDisplayList);this.hlDisplayList=t.pool.acquire();a.forEach(function(a){if(a=c.displayObjectRegistry.get(a)){a=a.displayRecords.map(function(a){var c=b.pool.acquire();c.id=a.id;c.geometryType=a.geometryType;c.vertexFrom=a.vertexFrom;c.vertexCount=a.vertexCount;c.indexFrom=a.indexFrom;c.indexCount=a.indexCount;c.materialInfo=a.materialInfo;c.meshData=null;c.sortKey=0;c.symbolLevel=0;c.zOrder=0;return c});a.sort(function(b,a){return b.sortKey-a.sortKey});c.hlDisplayList.addToList(a);
for(var f=0;f<a.length;f++)b.pool.release(a[f])}})};q.pool=new a(q);return q}(f)})},"esri/core/libs/gl-matrix/vec2":function(){define(["./common"],function(n){var h={create:function(){var d=new n.ARRAY_TYPE(2);d[0]=0;d[1]=0;return d},clone:function(d){var a=new n.ARRAY_TYPE(2);a[0]=d[0];a[1]=d[1];return a},fromValues:function(d,a){var c=new n.ARRAY_TYPE(2);c[0]=d;c[1]=a;return c},copy:function(d,a){d[0]=a[0];d[1]=a[1];return d},set:function(d,a,c){d[0]=a;d[1]=c;return d},add:function(d,a,c){d[0]=
a[0]+c[0];d[1]=a[1]+c[1];return d},subtract:function(d,a,c){d[0]=a[0]-c[0];d[1]=a[1]-c[1];return d}};h.sub=h.subtract;h.multiply=function(d,a,c){d[0]=a[0]*c[0];d[1]=a[1]*c[1];return d};h.mul=h.multiply;h.divide=function(d,a,c){d[0]=a[0]/c[0];d[1]=a[1]/c[1];return d};h.div=h.divide;h.ceil=function(d,a){d[0]=Math.ceil(a[0]);d[1]=Math.ceil(a[1]);return d};h.floor=function(d,a){d[0]=Math.floor(a[0]);d[1]=Math.floor(a[1]);return d};h.min=function(d,a,c){d[0]=Math.min(a[0],c[0]);d[1]=Math.min(a[1],c[1]);
return d};h.max=function(d,a,c){d[0]=Math.max(a[0],c[0]);d[1]=Math.max(a[1],c[1]);return d};h.round=function(d,a){d[0]=Math.round(a[0]);d[1]=Math.round(a[1]);return d};h.scale=function(d,a,c){d[0]=a[0]*c;d[1]=a[1]*c;return d};h.scaleAndAdd=function(d,a,c,g){d[0]=a[0]+c[0]*g;d[1]=a[1]+c[1]*g;return d};h.distance=function(d,a){var c=a[0]-d[0];d=a[1]-d[1];return Math.sqrt(c*c+d*d)};h.dist=h.distance;h.squaredDistance=function(d,a){var c=a[0]-d[0];d=a[1]-d[1];return c*c+d*d};h.sqrDist=h.squaredDistance;
h.length=function(d){var a=d[0];d=d[1];return Math.sqrt(a*a+d*d)};h.len=h.length;h.squaredLength=function(d){var a=d[0];d=d[1];return a*a+d*d};h.sqrLen=h.squaredLength;h.negate=function(d,a){d[0]=-a[0];d[1]=-a[1];return d};h.inverse=function(d,a){d[0]=1/a[0];d[1]=1/a[1];return d};h.normalize=function(d,a){var c=a[0],g=a[1],c=c*c+g*g;0<c&&(c=1/Math.sqrt(c),d[0]=a[0]*c,d[1]=a[1]*c);return d};h.dot=function(d,a){return d[0]*a[0]+d[1]*a[1]};h.cross=function(d,a,c){a=a[0]*c[1]-a[1]*c[0];d[0]=d[1]=0;d[2]=
a;return d};h.lerp=function(d,a,c,g){var e=a[0];a=a[1];d[0]=e+g*(c[0]-e);d[1]=a+g*(c[1]-a);return d};h.random=function(d,a){a=a||1;var c=2*n.RANDOM()*Math.PI;d[0]=Math.cos(c)*a;d[1]=Math.sin(c)*a;return d};h.transformMat2=function(d,a,c){var g=a[0];a=a[1];d[0]=c[0]*g+c[2]*a;d[1]=c[1]*g+c[3]*a;return d};h.transformMat2d=function(d,a,c){var g=a[0];a=a[1];d[0]=c[0]*g+c[2]*a+c[4];d[1]=c[1]*g+c[3]*a+c[5];return d};h.transformMat3=function(d,a,c){var g=a[0];a=a[1];d[0]=c[0]*g+c[3]*a+c[6];d[1]=c[1]*g+c[4]*
a+c[7];return d};h.transformMat4=function(d,a,c){var g=a[0];a=a[1];d[0]=c[0]*g+c[4]*a+c[12];d[1]=c[1]*g+c[5]*a+c[13];return d};h.forEach=function(){var d=h.create();return function(a,c,g,e,f,b){c||(c=2);g||(g=0);for(e=e?Math.min(e*c+g,a.length):a.length;g<e;g+=c)d[0]=a[g],d[1]=a[g+1],f(d,d,b),a[g]=d[0],a[g+1]=d[1];return a}}();h.str=function(d){return"vec2("+d[0]+", "+d[1]+")"};h.exactEquals=function(d,a){return d[0]===a[0]&&d[1]===a[1]};h.equals=function(d,a){var c=d[0];d=d[1];var g=a[0];a=a[1];
return Math.abs(c-g)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(d-a)<=n.EPSILON*Math.max(1,Math.abs(d),Math.abs(a))};return h})},"esri/views/2d/engine/webgl/WGLGeometry":function(){define(["require","exports","../../../webgl/BufferObject","./FreeList","./enums"],function(n,h,d,a,c){return function(){function g(){this._bufferSpec={};this._ibFreeList=this._vbFreeList=null;this.vertexBufferMap={};this.vertexBufferMapCPU={};this.vao=this.indexBufferCPU=this.indexBuffer=null;this.usage=35044}
Object.defineProperty(g.prototype,"attached",{get:function(){return null!==this.indexBuffer},enumerable:!0,configurable:!0});g.prototype.attach=function(a){for(var c in this._bufferSpec)this.vertexBufferMap[c]=d.createVertex(a.context,this.usage,this.vertexBufferMapCPU[c].buffer);this.indexBufferCPU&&(this.indexBuffer=d.createIndex(a.context,this.usage,this.indexBufferCPU));return!0};g.prototype.initializeEmpty=function(c,f,b,d){void 0===d&&(d=35044);this.clear();this.usage=d;b&&(this.indexBufferCPU=
new Uint32Array(b));var e;for(d=0;d<c.length;d++){var k=c[d];e=0!==k.divisor?Math.ceil(f/k.divisor):f;e*=k.strideInBytes;this._bufferSpec[k.name]=k;this.vertexBufferMapCPU[k.name]=new Uint32Array(e/4)}this._vbFreeList=a.create(f);b&&(this._ibFreeList=a.create(b))};g.prototype.initializeWithRecords=function(a,c,b){void 0===b&&(b=35044);c.sort(function(b,a){return b.sortKey-a.sortKey});for(var d=0,f=0,e=0;e<c.length;e++){var g=c[e],d=d+g.meshData.vertexCount;g.meshData.indexData&&(f+=g.meshData.indexData.length);
g.indexFrom=void 0;g.indexCount=0;g.vertexFrom=void 0;g.vertexCount=0}this.initializeEmpty(a,Math.floor(1.5*d),Math.floor(1.5*f),b);this.update(c)};g.prototype.initializeWithBuffers=function(c,d,b){void 0===b&&(b=35044);this.clear();this.usage=b;this.indexBufferCPU=d.indexBuffer;b=this.indexBufferCPU.length;for(var f=void 0,e=0;e<c.length;e++){var g=c[e];this._bufferSpec[g.name]=g;this.vertexBufferMapCPU[g.name]=d.vertexBuffer[g.name].data;g=d.vertexBuffer[g.name].data.buffer.byteLength/g.strideInBytes;
void 0!==f&&f!==g?console.error("Buffers with different vertex counts."):f=g}this._vbFreeList=a.create(f);this._vbFreeList.allocate(f);this._ibFreeList=a.create(b);this._ibFreeList.allocate(b)};g.prototype.clear=function(){this.indexBuffer&&(this.indexBuffer.dispose(),this.indexBuffer=null);this.indexBufferCPU=null;for(var a in this.vertexBufferMap)this.vertexBufferMap[a].dispose(),delete this.vertexBufferMap[a];this.vertexBufferMap={};this.vertexBufferMapCPU={};this.vao&&(this.vao.dispose(),this.vao=
null);this._bufferSpec={};this._ibFreeList=this._vbFreeList=null};g.prototype.update=function(a){for(var d=0;d<a.length;d++){var b=this._updateRecord(a[d]);if(b!==c.WGLGeometryTransactionStatus.SUCCEEDED)return b}return c.WGLGeometryTransactionStatus.SUCCEEDED};g.prototype._updateRecord=function(a){var d;void 0===a.vertexFrom||a.vertexCount!==a.meshData.vertexCount?(void 0!==a.vertexFrom&&this._vbFreeList.free(a.vertexFrom,a.vertexCount),d=0<a.meshData.vertexCount?this._vbFreeList.allocate(a.meshData.vertexCount):
-1):d=a.vertexFrom;-1!==d?(a.vertexFrom=d,a.vertexCount=a.meshData.vertexCount):(a.vertexFrom=void 0,a.vertexCount=0);var b=a.meshData.indexData?a.meshData.indexData.length:0;void 0===a.indexFrom||a.indexCount!==b?(void 0!==a.indexFrom&&this._ibFreeList.free(a.indexFrom,a.indexCount),d=0<b?this._ibFreeList.allocate(b):-1):d=a.indexFrom;-1!==d?(a.indexFrom=d,a.indexCount=b):(a.indexFrom=void 0,a.indexCount=0);if(void 0!==a.vertexFrom&&void 0!==a.indexFrom){var e;e=b=d=d=void 0;for(var g in a.meshData.vertexData){d=
this._bufferSpec[g].divisor;e=0!==d?a.vertexFrom/d:a.vertexFrom;d=this.vertexBufferMapCPU[g];var b=a.meshData.vertexData[g],l=b.length;e=e*this._bufferSpec[g].strideInBytes/4;for(var h=0;h<l;h++)d[e+h]=b[h]}g=a.vertexFrom;b=(d=a.meshData.indexData)?d.length:0;for(l=0;l<b;++l)this.indexBufferCPU[a.indexFrom+l]=g+d[l];return c.WGLGeometryTransactionStatus.SUCCEEDED}return c.WGLGeometryTransactionStatus.FAILED_OUT_OF_MEMORY};g.prototype.remove=function(a){for(var c=0;c<a.length;c++)this._removeRecord(a[c])};
g.prototype._removeRecord=function(a){this._vbFreeList.free(a.vertexFrom,a.vertexCount);a.vertexFrom=void 0;a.vertexCount=0;this._ibFreeList.free(a.indexFrom,a.indexCount);a.indexFrom=void 0;a.indexCount=0};g.prototype.invalidateIndexBuffer=function(){var a=this.indexBuffer;a&&a.setData(this.indexBufferCPU)};g.prototype.invalidateVertexBuffers=function(a){if(!a){a=[];for(var c in this.vertexBufferMap)a.push(c)}for(var b=0;b<a.length;b++){c=a[b];var d=this.vertexBufferMap[c];d&&d.setData(this.vertexBufferMapCPU[c].buffer)}};
return g}()})},"esri/views/2d/engine/webgl/FreeList":function(){define(["require","exports"],function(n,h){Object.defineProperty(h,"__esModule",{value:!0});var d=function(){function a(a){this._parent=a}a.prototype.rangeCreated=function(a){};a.prototype.rangeResized=function(a,c,d){};a.prototype.findBestRange=function(a){for(var c=this._parent._freeHead;null!==c&&a>c.count;)c=c.next;return c};a.prototype.findAdjacentRanges=function(a,c){for(var d=!0,b=!1,e=null,g=this._parent._freeHead;d&&!b;){var l=
null!==g?g.from:this._parent._size;a>=(null!==e?e.from+e.count:0)&&a+c<=l?(d=!1,b=!0):null!==g?(e=g,g=g.next):d=!1}return[e,g]};return a}();n=function(){function a(){this._rangesSortedByFrom=[];this._rangesSortedByCount=[]}a.prototype.rangeCreated=function(a){this._rangesSortedByFrom.push(a);this._rangesSortedByFrom.sort(function(a,c){return a.from-c.from});this._rangesSortedByCount.push(a);this._rangesSortedByCount.sort(function(a,c){return a.count-c.count})};a.prototype.rangeResized=function(a,
c,d){0===a.count?(this._rangesSortedByFrom.splice(this._rangesSortedByFrom.indexOf(a),1),this._rangesSortedByCount.splice(this._rangesSortedByCount.indexOf(a),1)):this._rangesSortedByCount.sort(function(b,a){return b.count-a.count})};a.prototype.findBestRange=function(a){if(0===this._rangesSortedByCount.length)return null;for(var c=0,d=this._rangesSortedByCount.length-1,b=void 0;c<=d;){var k=Math.floor((c+d)/2),g=this._rangesSortedByCount[k].count;if(g===a){b=k;break}else g<a?c=k+1:g>a&&(d=k-1,b=
k)}return void 0===b?null:this._rangesSortedByCount[b]};a.prototype.findAdjacentRanges=function(a,c){if(0===this._rangesSortedByFrom.length)return[null,null];if(a+c<=this._rangesSortedByFrom[0].from)return[null,this._rangesSortedByFrom[0]];if(a>=this._rangesSortedByFrom[this._rangesSortedByFrom.length-1].from+this._rangesSortedByFrom[this._rangesSortedByFrom.length-1].count)return[this._rangesSortedByFrom[this._rangesSortedByFrom.length-1],null];for(var d=0;d<this._rangesSortedByFrom.length-1;++d){var b=
this._rangesSortedByFrom[d],e=this._rangesSortedByFrom[d+1];if(a>=b.from+b.count&&a+c<=e.from)return[b,e]}throw Error("Could not find adjacent ranges.");};return a}();h.SortingBookKeeper=n;var a=function(){function a(a,c){this._size=a;this._bookKeeper=c||new d(this);0<a?(this._freeHead={from:0,count:a,prev:null,next:null},this._bookKeeper.rangeCreated(this._freeHead)):this._freeHead=null}a.prototype.allocate=function(c){var d=this._bookKeeper.findBestRange(c);if(null===d)return-1;var f=d.from,b=d.count;
d.from+=c;d.count-=c;this._bookKeeper.rangeResized(d,f,b);0===d.count&&(c=null!==d.prev?this._freeHead:d.next,a._removeRange(d),this._freeHead=c);return f};a.prototype.free=function(c,d){var f=this._bookKeeper.findAdjacentRanges(c,d),b=f[0],f=f[1];c={from:c,count:d,prev:b,next:f};null!==b&&(b.next=c);null!==f&&(f.prev=c);this._bookKeeper.rangeCreated(c);if(null!==f&&c.from+c.count===f.from){d=c.from;var e=c.count;a._fuse(c,f);a._removeRange(f);this._bookKeeper.rangeResized(c,d,e);this._bookKeeper.rangeResized(f,
void 0,0)}null!==b&&b.from+b.count===c.from&&(d=b.from,e=b.count,a._fuse(b,c),a._removeRange(c),this._bookKeeper.rangeResized(b,d,e),this._bookKeeper.rangeResized(c,void 0,0));this._freeHead=null!==c.prev?this._freeHead:c};a._removeRange=function(a){null!==a.prev?null!==a.next?(a.prev.next=a.next,a.next.prev=a.prev):a.prev.next=null:null!==a.next&&(a.next.prev=null)};a._fuse=function(a,c){a.count+=c.count;a.next=c.next;c.from+=c.count;c.count=0;null!==c.next&&(c.next.prev=a)};return a}();h.DefaultFreeList=
a;h.create=function(c){return new a(c)}})},"esri/views/2d/engine/webgl/WGLFeatureView":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/libs/gl-matrix/vec3 ../../../../core/libs/gl-matrix/mat4 ../../../../core/promiseUtils ../../../../geometry/Point ../Container ./GeometryUtils ./WGLRendererInfo ./TextureManager ./Utils".split(" "),function(n,h,d,a,c,g,e,f,b,k,m,l){return function(f){function p(b,d,e){var k=f.call(this)||this;k._displayWidth=0;k._displayHeight=
0;k._pointToCallbacks=new Map;k._highlightIDs=new Set;k._highlightOptionsUpToDate=!1;k.textureManager=new m;k._tileCoordRange=d;k._tileCoordRatio=d/b;k._parentLayerView=e;k._oneOverTileRatio=1/k._tileCoordRatio;k._tileCoordinateScale=a.create();k._orientationVec=a.create();k._displayScale=a.create();k._orientationVec.set([0,0,1]);k._defaultTransform=c.create();return k}d(p,f);Object.defineProperty(p.prototype,"highlightOptions",{get:function(){return this._highlightOptions},set:function(b){this._highlightOptions=
b;this._highlightOptionsUpToDate=!1},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"displayWidth",{get:function(){return this._displayWidth},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"displayHeight",{get:function(){return this._displayHeight},enumerable:!0,configurable:!0});p.prototype.initialize=function(b){this._tileInfoView=b;this.wglRendererInfo=new k(this)};p.prototype.updateHeatmapParameters=function(b){this.wglRendererInfo.updateHeatmapParameters(b);
this.requestRender()};p.prototype.hitTest=function(b,a){var c=this,d=[b,a];return g.create(function(b,a){c._pointToCallbacks.set(d,{resolve:b,reject:a});c.requestRender()},function(){c._pointToCallbacks.has(d)&&c._pointToCallbacks.delete(d)})};p.prototype.setHighlight=function(b){this._highlightIDs.clear();this.addHighlight(b)};p.prototype.addHighlight=function(b){var a=this;b.forEach(function(b){a._highlightIDs.add(b)});this._buildHLList()};p.prototype.removeHighlight=function(b){var a=this;b.forEach(function(b){a._highlightIDs.delete(b)});
this._buildHLList()};p.prototype.addChild=function(b){b=f.prototype.addChild.call(this,b);this._buildHLList();return b};p.prototype.removeChild=function(b){b=f.prototype.removeChild.call(this,b);this._buildHLList();return b};p.prototype.prepareChildrenRenderParameters=function(b){return b};p.prototype.renderChildren=function(b){var a=this;this.wglRendererInfo.updateVisualVariables(this._parentLayerView.visualVariablesInfo.vvRanges,b.state);var c=this.parent.glPainter;this.sortChildren(function(b,
a){return b.key.level-a.key.level});var d=this._tileInfoView.getClosestInfoForScale(b.state.scale).level;this.wglRendererInfo.heatmapParameters?c.drawHeatmap(b.context,this,d,b.devicePixelRatio):c.draw(b.context,this,d,b.devicePixelRatio,b.stationary);0<this._highlightIDs.size&&c.highlight(b.context,this,d,b.devicePixelRatio);0!==this._pointToCallbacks.size&&(this._pointToCallbacks.forEach(function(c,d){c.resolve(a._hitTest(b,d[0],d[1]))}),this._pointToCallbacks.clear())};p.prototype.attachChild=
function(b,a){return b.attach(a)};p.prototype.detachChild=function(b,a){b.detach(a)};p.prototype.renderChild=function(b,a){b.doRender(a)};p.prototype.beforeRenderChildren=function(b,a){this._updateTilesTransform(b.state,this._tileInfoView.getClosestInfoForScale(b.state.scale).level);this._updateHighlightOptions()};p.prototype._hitTest=function(b,a,c){var d=this.parent.glPainter,f=this._tileInfoView.getClosestInfoForScale(b.state.scale).level,k=[0,0];b.state.toMap(k,[a,c]);var g=b.state.clone(),m=
g.viewpoint.clone();m.targetGeometry=new e(k[0],k[1],b.state.spatialReference);g.viewpoint=m;g.size=[l.C_HITTEST_SEARCH_SIZE,l.C_HITTEST_SEARCH_SIZE];this._updateTilesTransform(g,f);d.update(g,b.devicePixelRatio);return d.hitTest({context:b.context,budget:b.budget,state:g,devicePixelRatio:b.devicePixelRatio,stationary:b.stationary},a,c,this,f)};p.prototype._updateTilesTransform=function(b,a){var c=1/b.width,d=1/b.height,f=[0,0];this._calculateRelativeViewProjMat(this._tileInfoView.tileInfo.lods[a].resolution,
b.resolution,b.rotation,this._tileInfoView.tileInfo.size[0],this._tileCoordRange,b.width,b.height,this._defaultTransform);for(var e=0,k=this.children;e<k.length;e++){var g=k[e];b.toScreen(f,g.coords);f[1]=b.height-f[1];g.tileTransform.displayCoord[0]=2*f[0]*c-1;g.tileTransform.displayCoord[1]=2*f[1]*d-1;g.key.level===a?g.tileTransform.transform.set(this._defaultTransform):this._calculateRelativeViewProjMat(this._tileInfoView.tileInfo.lods[g.key.level].resolution,b.resolution,b.rotation,this._tileInfoView.tileInfo.size[0],
g.coordRange,b.width,b.height,g.tileTransform.transform)}};p.prototype._calculateRelativeViewProjMat=function(a,d,f,e,k,g,m,l){a=a/d*this._oneOverTileRatio;this._tileCoordinateScale.set([a,a,1]);if(g!==this._displayWidth||m!==this._displayHeight)this._displayScale.set([2/g,-2/m,1]),this._displayWidth=g,this._displayHeight=m;c.identity(l);c.scale(l,l,this._tileCoordinateScale);c.rotate(l,l,-f*b.C_DEG_TO_RAD,this._orientationVec);c.scale(l,l,this._displayScale);c.transpose(l,l)};p.prototype._updateHighlightOptions=
function(){!this._highlightOptionsUpToDate&&this._setHighlightOptions(this._highlightOptions)&&(this._highlightOptionsUpToDate=!0)};p.prototype._setHighlightOptions=function(b){if(!this.parent)return!1;var a=this.parent.glPainter;if(!a)return!1;var c=b.color.toRgba();c[0]/=255;c[1]/=255;c[2]/=255;var d=c.slice();c[3]*=b.fillOpacity;d[3]*=b.haloOpacity;a.setHighlightOptions({fillColor:c,outlineColor:d,outlineWidth:2,outerHaloWidth:.3,innerHaloWidth:.3,outlinePosition:0});return!0};p.prototype._buildHLList=
function(){var b=this;this.children.forEach(function(a){a.buildHLList(b._highlightIDs)});this.requestRender()};return p}(f)})},"esri/core/libs/gl-matrix/vec3":function(){define(["./common"],function(n){var h={create:function(){var d=new n.ARRAY_TYPE(3);d[0]=0;d[1]=0;d[2]=0;return d},clone:function(d){var a=new n.ARRAY_TYPE(3);a[0]=d[0];a[1]=d[1];a[2]=d[2];return a},fromValues:function(d,a,c){var g=new n.ARRAY_TYPE(3);g[0]=d;g[1]=a;g[2]=c;return g},copy:function(d,a){d[0]=a[0];d[1]=a[1];d[2]=a[2];
return d},set:function(d,a,c,g){d[0]=a;d[1]=c;d[2]=g;return d},add:function(d,a,c){d[0]=a[0]+c[0];d[1]=a[1]+c[1];d[2]=a[2]+c[2];return d},subtract:function(d,a,c){d[0]=a[0]-c[0];d[1]=a[1]-c[1];d[2]=a[2]-c[2];return d}};h.sub=h.subtract;h.multiply=function(d,a,c){d[0]=a[0]*c[0];d[1]=a[1]*c[1];d[2]=a[2]*c[2];return d};h.mul=h.multiply;h.divide=function(d,a,c){d[0]=a[0]/c[0];d[1]=a[1]/c[1];d[2]=a[2]/c[2];return d};h.div=h.divide;h.ceil=function(d,a){d[0]=Math.ceil(a[0]);d[1]=Math.ceil(a[1]);d[2]=Math.ceil(a[2]);
return d};h.floor=function(d,a){d[0]=Math.floor(a[0]);d[1]=Math.floor(a[1]);d[2]=Math.floor(a[2]);return d};h.min=function(d,a,c){d[0]=Math.min(a[0],c[0]);d[1]=Math.min(a[1],c[1]);d[2]=Math.min(a[2],c[2]);return d};h.max=function(d,a,c){d[0]=Math.max(a[0],c[0]);d[1]=Math.max(a[1],c[1]);d[2]=Math.max(a[2],c[2]);return d};h.round=function(d,a){d[0]=Math.round(a[0]);d[1]=Math.round(a[1]);d[2]=Math.round(a[2]);return d};h.scale=function(d,a,c){d[0]=a[0]*c;d[1]=a[1]*c;d[2]=a[2]*c;return d};h.scaleAndAdd=
function(d,a,c,g){d[0]=a[0]+c[0]*g;d[1]=a[1]+c[1]*g;d[2]=a[2]+c[2]*g;return d};h.distance=function(d,a){var c=a[0]-d[0],g=a[1]-d[1];d=a[2]-d[2];return Math.sqrt(c*c+g*g+d*d)};h.dist=h.distance;h.squaredDistance=function(d,a){var c=a[0]-d[0],g=a[1]-d[1];d=a[2]-d[2];return c*c+g*g+d*d};h.sqrDist=h.squaredDistance;h.length=function(d){var a=d[0],c=d[1];d=d[2];return Math.sqrt(a*a+c*c+d*d)};h.len=h.length;h.squaredLength=function(d){var a=d[0],c=d[1];d=d[2];return a*a+c*c+d*d};h.sqrLen=h.squaredLength;
h.negate=function(d,a){d[0]=-a[0];d[1]=-a[1];d[2]=-a[2];return d};h.inverse=function(d,a){d[0]=1/a[0];d[1]=1/a[1];d[2]=1/a[2];return d};h.normalize=function(d,a){var c=a[0],g=a[1],e=a[2],c=c*c+g*g+e*e;0<c&&(c=1/Math.sqrt(c),d[0]=a[0]*c,d[1]=a[1]*c,d[2]=a[2]*c);return d};h.dot=function(d,a){return d[0]*a[0]+d[1]*a[1]+d[2]*a[2]};h.cross=function(d,a,c){var g=a[0],e=a[1];a=a[2];var f=c[0],b=c[1];c=c[2];d[0]=e*c-a*b;d[1]=a*f-g*c;d[2]=g*b-e*f;return d};h.lerp=function(d,a,c,g){var e=a[0],f=a[1];a=a[2];
d[0]=e+g*(c[0]-e);d[1]=f+g*(c[1]-f);d[2]=a+g*(c[2]-a);return d};h.hermite=function(d,a,c,g,e,f){var b=f*f,k=b*(2*f-3)+1,m=b*(f-2)+f,l=b*(f-1);f=b*(3-2*f);d[0]=a[0]*k+c[0]*m+g[0]*l+e[0]*f;d[1]=a[1]*k+c[1]*m+g[1]*l+e[1]*f;d[2]=a[2]*k+c[2]*m+g[2]*l+e[2]*f;return d};h.bezier=function(d,a,c,g,e,f){var b=1-f,k=b*b,m=f*f,l=k*b,k=3*f*k,b=3*m*b;f*=m;d[0]=a[0]*l+c[0]*k+g[0]*b+e[0]*f;d[1]=a[1]*l+c[1]*k+g[1]*b+e[1]*f;d[2]=a[2]*l+c[2]*k+g[2]*b+e[2]*f;return d};h.random=function(d,a){a=a||1;var c=2*n.RANDOM()*
Math.PI,g=2*n.RANDOM()-1,e=Math.sqrt(1-g*g)*a;d[0]=Math.cos(c)*e;d[1]=Math.sin(c)*e;d[2]=g*a;return d};h.transformMat4=function(d,a,c){var g=a[0],e=a[1];a=a[2];var f=c[3]*g+c[7]*e+c[11]*a+c[15],f=f||1;d[0]=(c[0]*g+c[4]*e+c[8]*a+c[12])/f;d[1]=(c[1]*g+c[5]*e+c[9]*a+c[13])/f;d[2]=(c[2]*g+c[6]*e+c[10]*a+c[14])/f;return d};h.transformMat3=function(d,a,c){var g=a[0],e=a[1];a=a[2];d[0]=g*c[0]+e*c[3]+a*c[6];d[1]=g*c[1]+e*c[4]+a*c[7];d[2]=g*c[2]+e*c[5]+a*c[8];return d};h.transformQuat=function(d,a,c){var g=
a[0],e=a[1],f=a[2];a=c[0];var b=c[1],k=c[2];c=c[3];var m=c*g+b*f-k*e,l=c*e+k*g-a*f,h=c*f+a*e-b*g,g=-a*g-b*e-k*f;d[0]=m*c+g*-a+l*-k-h*-b;d[1]=l*c+g*-b+h*-a-m*-k;d[2]=h*c+g*-k+m*-b-l*-a;return d};h.rotateX=function(d,a,c,g){var e=[],f=[];e[0]=a[0]-c[0];e[1]=a[1]-c[1];e[2]=a[2]-c[2];f[0]=e[0];f[1]=e[1]*Math.cos(g)-e[2]*Math.sin(g);f[2]=e[1]*Math.sin(g)+e[2]*Math.cos(g);d[0]=f[0]+c[0];d[1]=f[1]+c[1];d[2]=f[2]+c[2];return d};h.rotateY=function(d,a,c,g){var e=[],f=[];e[0]=a[0]-c[0];e[1]=a[1]-c[1];e[2]=
a[2]-c[2];f[0]=e[2]*Math.sin(g)+e[0]*Math.cos(g);f[1]=e[1];f[2]=e[2]*Math.cos(g)-e[0]*Math.sin(g);d[0]=f[0]+c[0];d[1]=f[1]+c[1];d[2]=f[2]+c[2];return d};h.rotateZ=function(d,a,c,g){var e=[],f=[];e[0]=a[0]-c[0];e[1]=a[1]-c[1];e[2]=a[2]-c[2];f[0]=e[0]*Math.cos(g)-e[1]*Math.sin(g);f[1]=e[0]*Math.sin(g)+e[1]*Math.cos(g);f[2]=e[2];d[0]=f[0]+c[0];d[1]=f[1]+c[1];d[2]=f[2]+c[2];return d};h.forEach=function(){var d=h.create();return function(a,c,g,e,f,b){c||(c=3);g||(g=0);for(e=e?Math.min(e*c+g,a.length):
a.length;g<e;g+=c)d[0]=a[g],d[1]=a[g+1],d[2]=a[g+2],f(d,d,b),a[g]=d[0],a[g+1]=d[1],a[g+2]=d[2];return a}}();h.angle=function(d,a){d=h.fromValues(d[0],d[1],d[2]);a=h.fromValues(a[0],a[1],a[2]);h.normalize(d,d);h.normalize(a,a);a=h.dot(d,a);return 1<a?0:Math.acos(a)};h.str=function(d){return"vec3("+d[0]+", "+d[1]+", "+d[2]+")"};h.exactEquals=function(d,a){return d[0]===a[0]&&d[1]===a[1]&&d[2]===a[2]};h.equals=function(d,a){var c=d[0],g=d[1];d=d[2];var e=a[0],f=a[1];a=a[2];return Math.abs(c-e)<=n.EPSILON*
Math.max(1,Math.abs(c),Math.abs(e))&&Math.abs(g-f)<=n.EPSILON*Math.max(1,Math.abs(g),Math.abs(f))&&Math.abs(d-a)<=n.EPSILON*Math.max(1,Math.abs(d),Math.abs(a))};return h})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("require exports ../../../../geometry/support/scaleUtils ../../../../core/screenUtils ../../../../renderers/support/utils ./Utils".split(" "),function(n,h,d,a,c,g){function e(a,b){var c=b.length;if(a<b[0].value||1===c)return b[0].size;for(var d=1;d<c;d++)if(a<b[d].value)return b[d-
1].size+(a-b[d-1].value)/(b[d].value-b[d-1].value)*(b[d].size-b[d-1].size);return b[c-1].size}return function(){function f(b){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.vvSizeFieldStopsValues=new Float32Array(6);this.vvSizeFieldStopsSizes=new Float32Array(6);this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,
vvRotationType:"geographic",vvOpacityEnabled:!1};this.symbolLevels.push(0)}Object.defineProperty(f.prototype,"vvMaterialParameters",{get:function(){return this._vvMaterialParameters},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"heatmapParameters",{get:function(){return this._heatmapParameters},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"vvMaterialParams",{get:function(){return this._vvMaterialParameters},enumerable:!0,configurable:!0});f.prototype.updateHeatmapParameters=
function(b){var a=b.blurRadius,c=Math.round(4.5*b.blurRadius),d=2*c+1;this._heatmapParameters||(this._heatmapParameters={radius:a,blurRadius:c,kernelSize:d,refreshIntensityKernel:!0,intensityKernel:null,color:null,maxPixelIntensity:b.maxPixelIntensity,minPixelIntensity:b.minPixelIntensity});for(var f=this._heatmapParameters,e=b.colorStops,h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0],u,n=0;16>n;n++){var y=e[Math.min(n,e.length-1)];h[n]=y.ratio;u=4*n;r[u+0]=y.color[0]/255;r[u+1]=y.color[1]/255;r[u+2]=y.color[2]/255;r[u+3]=1<y.color[3]?y.color[3]/255:y.color[3];g.premultiplyAlpha(r,u,!0)}f.color={values:h,colors:r,refreshColorRamp:!0};1E-6<Math.abs(f.radius-b.radius)&&(f.radius=a,f.blurRadius=c,f.kernelSize=d,f.refreshIntensityKernel=!0);f.maxPixelIntensity=b.maxPixelIntensity;f.minPixelIntensity=b.minPixelIntensity};f.prototype.updateVisualVariables=function(b,f){var k=
this._vvMaterialParameters;k.vvOpacityEnabled=!1;k.vvSizeEnabled=!1;k.vvColorEnabled=!1;k.vvRotationEnabled=!1;if(b){var l=b.size;if(l){k.vvSizeEnabled=!0;if(l.minMaxValue){var h=l.minMaxValue,p=void 0,q=void 0;g.isDefined(h.minSize)&&g.isDefined(h.maxSize)&&(g.isNumber(h.minSize)&&g.isNumber(h.maxSize)?(p=a.pt2px(h.minSize),q=a.pt2px(h.maxSize)):(q=f.scale,p=a.pt2px(e(q,h.minSize.stops)),q=a.pt2px(e(q,h.maxSize.stops))));this.vvSizeMinMaxValue.set([h.minDataValue,h.maxDataValue,p,q])}l.scaleStops&&
(this.vvSizeScaleStopsValue=a.pt2px(e(f.scale,l.scaleStops.stops)));l.unitValue&&(this.vvSizeUnitValueToPixelsRatio=d.getMetersPerUnitForSR(f.spatialReference)/c.meterIn[l.unitValue.unit]/f.resolution);l.fieldStops&&(this.vvSizeFieldStopsValues.set(l.fieldStops.values),this.vvSizeFieldStopsSizes.set(l.fieldStops.sizes))}if(f=b.color)k.vvColorEnabled=!0,this.vvColorValues.set(f.values),this.vvColors.set(f.colors);if(f=b.opacity)k.vvOpacityEnabled=!0,this.vvOpacityValues.set(f.values),this.vvOpacities.set(f.opacities);
if(b=b.rotation)k.vvRotationEnabled=!0,k.vvRotationType=b.type}};return f}()})},"esri/views/2d/engine/webgl/TextureManager":function(){define("require exports dojo/Deferred ../../../../core/promiseUtils ../../../3d/support/imageUtils ./SpriteMosaic ./Utils ./CIMSymbolHelper ./SDFHelper ./GlyphSource ./GlyphMosaic".split(" "),function(n,h,d,a,c,g,e,f,b,k,m){var l=[];return function(){function h(){this._rasterizeQueue=new Map;this._spriteMosaic=new g(1024,1024,250);this._glyphSource=new k("https://basemaps.arcgis.com/v1/arcgis/rest/services/World_Basemap/VectorTileServer/resources/fonts/{fontstack}/{range}.pbf");
this._glyphMosaic=new m(1024,1024,this._glyphSource)}Object.defineProperty(h.prototype,"sprites",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"glyphs",{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0});h.prototype.processItems=function(b){var a=this;if(b.done)return!1;for(;this._spriteMosaic.hasItemsToProcess();)this._spriteMosaic.processNextItem();this._rasterizeQueue.forEach(function(c,d){if(b.done)return!1;var f=
a._rasterizeJSON(d);c.resolve(f);l.push(d)});for(var c=0;c<l.length;c++)this._rasterizeQueue.delete(l[c]);l.length=0;return!0};h.prototype.rasterizeItem=function(b,c){void 0===c&&(c=null);return b?!b.type||"text"!==b.type&&"esriTS"!==b.type?this._rasterizeSpriteSymbol(b).then(function(b){return{spriteMosaicItem:b}}):this._rasterizeTextSymbol(b,c).then(function(b){return{glyphMosaicItems:b}}):a.resolve(null)};h.prototype.bindSpritePage=function(b,a,c,d){d||(d=9729);this._spriteMosaic.bind(b,d,a,c)};
h.prototype.bindGlyphsPage=function(b,a,c){this._glyphMosaic.bind(b,9729,a,c)};h.prototype._rasterizeTextSymbol=function(b,a){return this._glyphMosaic.getGlyphItems(b,a)};h.prototype._rasterizeSpriteSymbol=function(b){var d=this;return!e.isFillSymbol(b)&&!e.isLineSymbol(b)||"solid"!==b.style&&"esriSFSSolid"!==b.style&&"esriSLSSolid"!==b.style&&"none"!==b.style?this._spriteMosaic.has(b)?a.resolve(this._spriteMosaic.getSpriteItem(b)):b.url||b.imageData?c.requestImage(b.url?b.url:"data:"+b.contentType+
";base64,"+b.imageData).then(function(a){return d._rasterizeResource(a).then(function(a){return d._addItemToMosaic(b,a.size,a.anchor,a.image,!e.isMarkerSymbol(b),a.sdf)})}):this._rasterizeResource(b).then(function(a){return d._addItemToMosaic(b,a.size,a.anchor,a.image,!e.isMarkerSymbol(b),a.sdf)}):a.resolve(null)};h.prototype._rasterizeResource=function(b){var a=this;if(this._rasterizeQueue.has(b))return this._rasterizeQueue.get(b).promise;var c=new d(function(){a._rasterizeQueue.has(b)&&a._rasterizeQueue.delete(b)});
if(b instanceof HTMLImageElement){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=b.width;this._rasterizationCanvas.height=b.height;var f=this._rasterizationCanvas.getContext("2d");f.drawImage(b,0,0,b.width,b.height);for(var f=f.getImageData(0,0,b.width,b.height),f=new Uint8Array(f.data),e=void 0,k=0;k<f.length;k+=4)e=f[k+3]/255,f[k]*=e,f[k+1]*=e,f[k+2]*=e;c.resolve({size:[b.width,b.height],anchor:[0,0],image:new Uint32Array(f.buffer),
sdf:!1})}else f=this._rasterizeJSON(b),c.resolve(f);return c.promise};h.prototype._addItemToMosaic=function(b,a,c,d,f,e){return this._spriteMosaic.addSpriteItem(b,a,c,d,f,e)};h.prototype._rasterizeJSON=function(a){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===a.type||"esriSFS"===a.type){var c=f.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,a.style);a=c[0];var d=c[1],c=c[2];return{size:[d,c],anchor:[0,0],image:new Uint32Array(a.buffer),
sdf:!1}}if("simple-line"===a.type||"esriSLS"===a.type)return c=f.SymbolHelper.rasterizeSimpleLine(this._rasterizationCanvas,a.style),a=c[0],d=c[1],c=c[2],{size:[d,c],anchor:[0,0],image:new Uint32Array(a.buffer),sdf:!0};"simple-marker"===a.type||"esriSMS"===a.type?(a=f.CIMSymbolHelper.fromSimpleMarker(a),d=!0):d=b.SDFHelper.checkSDF(a);if(d)return d=(new b.SDFHelper).buildSDF(a),a=d[0],{size:[d[1],d[2]],anchor:[0,0],image:new Uint32Array(a.buffer),sdf:!0};var e=f.CIMSymbolHelper.rasterize(this._rasterizationCanvas,
a);a=e[0];d=e[1];c=e[2];return{size:[d,c],anchor:[e[3],e[4]],image:new Uint32Array(a.buffer),sdf:!1}};return h}()})},"esri/views/3d/support/imageUtils":function(){define(["require","exports","dojo/Deferred","../../../core/urlUtils","../../../request"],function(n,h,d,a,c){function g(a){var c=!1,b=new Image,e=new d(function(){c=!0;b.src=""}),g=function(){c||e.reject()};b.onload=function(){c||e.resolve(b)};b.onerror=g;b.onabort=g;b.src=a;return e.promise}Object.defineProperty(h,"__esModule",{value:!0});
h.dataURItoBlob=function(a){var c=atob(a.split(",")[1]);a=a.split(",")[0].split(":")[1].split(";")[0];for(var b=new ArrayBuffer(c.length),d=new Uint8Array(b),e=0;e<c.length;e++)d[e]=c.charCodeAt(e);return new Blob([b],{type:a})};h.dataUriToImage=g;h.requestImage=function(d){return a.isDataProtocol(d)?g(d):c(d,{responseType:"image",allowImageDataAccess:!0}).then(function(a){return a.data})}})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("require exports ./Rect ./GeometryUtils ./RectangleBinPack ../../../webgl/Texture".split(" "),
function(n,h,d,a,c,g){return function(){function e(a,b,d){void 0===d&&(d=0);this._size=[];this._mosaicsData=[];this._textures=[];this._dirties=[];this._pageHeight=this._pageWidth=this._currentPage=this._maxItemSize=0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=a||0>=b)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=a;this._pageHeight=b;0<d&&(this._maxItemSize=d);this.pixelRatio=window.devicePixelRatio|1;this._binPack=
new c(this._pageWidth,this._pageHeight);this._mosaicsData[0]=new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight));this._dirties.push(!0);this._size.push([this._pageWidth,this._pageHeight]);this._textures.push(void 0)}e.prototype.getWidth=function(a){return a>=this._size.length?-1:this._size[a][0]};e.prototype.getHeight=function(a){return a>=this._size.length?-1:this._size[a][1]};e.prototype.getPage=function(a){return a<this._textures.length?this._textures[a]:null};e.prototype.has=
function(a){return this._mosaicRects.has(JSON.stringify(a))};e.prototype.getSpriteItem=function(a){return this._mosaicRects.get(JSON.stringify(a))};e.prototype.addSpriteItem=function(a,b,c,d,e,g){a=JSON.stringify(a);if(this._mosaicRects.has(a))return this._mosaicRects.get(a);var f=this._allocateImage(b[0],b[1]),k=f[0],l=f[1],f=f[2];if(0>=k.width||0>=k.height)return null;c={rect:k,width:b[0],height:b[1],anchorX:c[0],anchorY:c[1],sdf:g,pixelRatio:1,page:l};this._mosaicRects.set(a,c);this._copy({rect:k,
spriteSize:b,spriteData:d,page:l,pageSize:f,repeat:e,sdf:g});return c};e.prototype.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length};e.prototype.processNextItem=function(){var a=this._spriteCopyQueue.pop();a&&this._copy(a)};e.prototype.getSpriteItems=function(a){for(var b={},c=0;c<a.length;c++){var d=a[c];b[d]=this.getSpriteItem(d)}return b};e.prototype.getMosaicItemPosition=function(a,b){b=(a=this.getSpriteItem(a))&&a.rect;if(!b)return null;b.width=a.width;b.height=a.height;return{size:[a.width,
a.height],tl:[(b.x+1)/this._size[a.page][0],(b.y+1)/this._size[a.page][1]],br:[(b.x+1+a.width)/this._size[a.page][0],(b.y+1+a.height)/this._size[a.page][1]],page:a.page}};e.prototype.bind=function(a,b,c,d){void 0===c&&(c=0);void 0===d&&(d=0);this._textures[c]||(this._textures[c]=new g(a,{pixelFormat:6408,dataType:5121,width:this._size[c][0],height:this._size[c][1]},new Uint8Array(this._mosaicsData[c].buffer)));var f=this._textures[c];f.setSamplingMode(b);this._dirties[c]&&(f.setData(new Uint8Array(this._mosaicsData[c].buffer)),
f.generateMipmap());a.bindTexture(f,d);this._dirties[c]=!1};e._copyBits=function(a,b,c,d,e,g,h,q,r,n,w){var f=d*b+c;h=q*g+h;if(w)for(h-=g,w=-1;w<=n;w++,f=((w+n)%n+d)*b+c,h+=g)for(q=-1;q<=r;q++)e[h+q]=a[f+(q+r)%r];else for(w=0;w<n;w++){for(q=0;q<r;q++)e[h+q]=a[f+q];f+=b;h+=g}};e.prototype._copy=function(a){if(!(a.page>=this._mosaicsData.length)){var b=a.spriteData,c=this._mosaicsData[a.page];c&&b||console.error("Source or target images are uninitialized!");e._copyBits(b,a.spriteSize[0],0,0,c,a.pageSize[0],
a.rect.x+1,a.rect.y+1,a.spriteSize[0],a.spriteSize[1],a.repeat);this._dirties[a.page]=!0}};e.prototype._allocateImage=function(f,b){f+=2;b+=2;var e=Math.max(f,b);if(this._maxItemSize&&this._maxItemSize<e){var e=Math.pow(2,Math.ceil(a.log2(f))),g=Math.pow(2,Math.ceil(a.log2(b)));f=new d(0,0,f,b);this._mosaicsData.push(new Uint32Array(e*g));this._dirties.push(!0);this._size.push([e,g]);this._textures.push(void 0);return[f,this._mosaicsData.length-1,[e,g]]}e=this._binPack.allocate(f+(f%4?4-f%4:0),b+
(b%4?4-b%4:0));return 0>=e.width?(this._dirties[this._currentPage]||(this._mosaicsData[this._currentPage]=null),this._currentPage=this._mosaicsData.length,this._mosaicsData.push(new Uint32Array(this._pageWidth*this._pageHeight)),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0),this._binPack=new c(this._pageWidth,this._pageHeight),this._allocateImage(f,b)):[e,this._currentPage,[this._pageWidth,this._pageHeight]]};e.prototype._dispose=function(){this._binPack=
null;this._mosaicRects.clear()};return e}()})},"esri/views/2d/engine/webgl/Rect":function(){define(["require","exports"],function(n,h){return function(){function d(a,c,d,e){void 0===a&&(a=0);void 0===c&&(c=0);void 0===d&&(d=0);void 0===e&&(e=0);this.x=a;this.y=c;this.width=d;this.height=e}Object.defineProperty(d.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!0,configurable:!0});return d}()})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["require",
"exports","./Rect"],function(n,h,d){return function(){function a(a,g){this._height=this._width=0;this._free=[];this._width=a;this._height=g;this._free.push(new d(0,0,a,g))}Object.defineProperty(a.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0});a.prototype.allocate=function(a,g){if(a>this._width||g>this._height)return new d;for(var c=null,f=-1,b=0;b<
this._free.length;++b){var k=this._free[b];a<=k.width&&g<=k.height&&(null===c||k.y<=c.y&&k.x<=c.x)&&(c=k,f=b)}if(null===c)return new d;this._free.splice(f,1);c.width<c.height?(c.width>a&&this._free.push(new d(c.x+a,c.y,c.width-a,g)),c.height>g&&this._free.push(new d(c.x,c.y+g,c.width,c.height-g))):(c.width>a&&this._free.push(new d(c.x+a,c.y,c.width-a,c.height)),c.height>g&&this._free.push(new d(c.x,c.y+g,a,c.height-g)));return new d(c.x,c.y,a,g)};a.prototype.release=function(a){for(var c=0;c<this._free.length;++c){var d=
this._free[c];if(d.y===a.y&&d.height===a.height&&d.x+d.width===a.x)d.width+=a.width;else if(d.x===a.x&&d.width===a.width&&d.y+d.height===a.y)d.height+=a.height;else if(a.y===d.y&&a.height===d.height&&a.x+a.width===d.x)d.x=a.x,d.width+=a.width;else if(a.x===d.x&&a.width===d.width&&a.y+a.height===d.y)d.y=a.y,d.height+=a.height;else continue;this._free.splice(c,1);this.release(a)}this._free.push(a)};return a}()})},"esri/views/2d/engine/webgl/CIMSymbolHelper":function(){define(["require","exports","../../../vectorTiles/GeometryUtils",
"./CIMSymbolDrawHelper","./SDFHelper"],function(n,h,d,a,c){Object.defineProperty(h,"__esModule",{value:!0});n=function(){function c(){}c.getEnvelope=function(c){if("CIMPointSymbol"!==c.type)return null;var d=new a.EnvDrawHelper;d.drawSymbol(c,{type:"point",x:0,y:0});return d.envelope()};c.rasterize=function(c,d){var b=this.getEnvelope(d);if(!b||0>=b.width||0>=b.height)return[null,0,0,0,0];var f=96/72,e=(b.x+.5*b.width)*f,g=-(b.y+.5*b.height)*f;c.width=b.width*f+2;c.height=b.height*f+2;b=c.getContext("2d");
f=a.Transformation.createScale(f,-f);f.translate(.5*c.width-e,.5*c.height-g);(new a.CanvasDrawHelper(b,f)).drawSymbol(d,{type:"point",x:0,y:0});d=b.getImageData(0,0,c.width,c.height);d=new Uint8Array(d.data);for(b=0;b<d.length;b+=4)f=d[b+3]/255,d[b]*=f,d[b+1]*=f,d[b+2]*=f;return[d,c.width,c.height,e/c.width,g/c.height]};c.fromSimpleMarker=function(a){var c,b,e=a.style;if("circle"===e||"esriSMSCircle"===e){c=Math.acos(.995);b=Math.ceil(d.C_PI/c/4);0===b&&(b=1);c=d.C_PI_BY_2/b;b*=4;e=[];e.push([50,
0]);for(var g=1;g<b;g++)e.push([50*Math.cos(g*c),-50*Math.sin(g*c)]);e.push([50,0]);c={rings:[e]};b={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("cross"===e||"esriSMSCross"===e)c=10,c={rings:[[[c,50],[c,c],[50,c],[50,-c],[c,-c],[c,-50],[-c,-50],[-c,-c],[-50,-c],[-50,c],[-c,c],[-c,50],[c,50]]]},b={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("diamond"===e||"esriSMSDiamond"===e)c={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},b={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("square"===e||"esriSMSSquare"===
e)c={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},b={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("x"===e||"esriSMSX"===e)c=14.142135623730951,c={rings:[[[0,c],[50-c,50],[50,50-c],[c,0],[50,c-50],[50-c,-50],[0,-c],[c-50,-50],[-50,c-50],[-c,0],[-50,50-c],[c-50,50],[0,c]]]},b={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("triangle"===e||"esriSMSTriangle"===e)b=2/3*100,e=b-100,c={rings:[[[-57.735026918962575,e],[0,b],[57.735026918962575,e],[-57.735026918962575,e]]]},b={xmin:-57.735026918962575,
ymin:e,xmax:57.735026918962575,ymax:b};var l;c&&b&&(l=[{type:"CIMSolidFill",enable:!0,color:a.color}],a.outline&&l.push({type:"CIMSolidStroke",enable:!0,width:a.outline.width,color:a.outline.color}),l={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:a.angle,size:a.size,offsetX:a.xoffset,offsetY:a.yoffset,frame:b,markerGraphics:[{type:"CIMMarkerGraphic",geometry:c,symbol:{type:"CIMPolygonSymbol",symbolLayers:l}}]}]});return l};return c}();h.CIMSymbolHelper=n;n=function(){function a(){}
a.rasterizeSimpleFill=function(a,c){"solid"!==c&&"none"!==c&&"esriSFSSolid"!==c&&"esriSFSNull"!==c||console.error("Unexpected: style does not require rasterization");a.width=8;a.height=8;var b=a.getContext("2d");b.strokeStyle="#FFFFFF";b.beginPath();if("vertical"===c||"cross"===c||"esriSFSCross"===c||"esriSFSVertical"===c)b.moveTo(0,0),b.lineTo(0,8);if("horizontal"===c||"cross"===c||"esriSFSCross"===c||"esriSFSHorizontal"===c)b.moveTo(0,0),b.lineTo(8,0);if("forward-diagonal"===c||"diagonal-cross"===
c||"esriSFSDiagonalCross"===c||"esriSFSForwardDiagonal"===c)b.moveTo(0,0),b.lineTo(8,8);if("backward-diagonal"===c||"diagonal-cross"===c||"esriSFSBackwardDiagonal"===c||"esriSFSDiagonalCross"===c)b.moveTo(8,0),b.lineTo(0,8);b.stroke();c=b.getImageData(0,0,a.width,a.height);c=new Uint8Array(c.data);for(var d=0;d<c.length;d+=4)b=c[d+3]/255,c[d]*=b,c[d+1]*=b,c[d+2]*=b;return[c,a.width,a.height]};a.rasterizeSimpleLine=function(a,d){var b;switch(d){case "dash":case "esriSLSDash":b=[3,2];break;case "dash-dot":case "esriSLSDashDot":b=
[2,2,0,2];break;case "dot":case "esriSLSDot":b=[0,3];break;case "long-dash":case "esriSLLongDash":b=[6,3];break;case "long-dash-dot":case "esriSLLongDashDot":b=[6,3,0,3];break;case "long-dash-dot-dot":case "esriSLLongDashDotDot":b=[2,2,0,2,0,2];break;case "short-dash":case "esriSLSShortDash":b=[2,2];break;case "short-dash-dot":case "esriSLSShortDashDot":b=[2,2,0,2];break;case "short-dash-dot-dot":case "esriSLSShortDashDotDot":b=[2,2,0,2,0,2];break;case "short-dot":case "esriSLSShortDot":b=[0,2];break;
case "solid":case "esriSLSSolid":throw Error("Unexpected: style does not require rasterization");case "none":throw Error("Unexpected: style does not require rasterization");}d=a=0;for(var f=b;d<f.length;d++){var e=f[d];a+=e}a*=16;f=31*a;d=new Float32Array(f);for(e=0;e<f;++e)d[e]=257;for(var g=f=.5,h=!0,p=0;p<b.length;p++){for(var e=b[p],f=g,g=g+16*e,q=f;q<g;){for(var r=.5;31>r;){var e=(31-r+1.5)*a+q-.5,n=(r-15.5)*(r-15.5);d[e]=h?n:Math.min((q-f)*(q-f)+n,(q-g)*(q-g)+n);r++}q++}h=!h}b=d.length;f=new Uint8Array(4*
b);for(e=0;e<b;++e)c.packFloat(Math.sqrt(d[e])/15,f,4*e);return[f,a,31]};return a}();h.SymbolHelper=n})},"esri/views/vectorTiles/GeometryUtils":function(){define(["require","exports"],function(n,h){function d(a,d){a%=d;return 0<=a?a:a+d}Object.defineProperty(h,"__esModule",{value:!0});h.C_INFINITY=Number.POSITIVE_INFINITY;h.C_PI=Math.PI;h.C_2PI=2*h.C_PI;h.C_PI_BY_2=h.C_PI/2;h.C_RAD_TO_256=128/h.C_PI;h.C_256_TO_RAD=h.C_PI/128;h.C_DEG_TO_256=256/360;h.C_DEG_TO_RAD=h.C_PI/180;h.C_SQRT2=1.414213562;h.C_SQRT2_INV=
1/h.C_SQRT2;var a=1/Math.LN2;h.positiveMod=d;h.radToByte=function(a){return d(a*h.C_RAD_TO_256,256)};h.degToByte=function(a){return d(a*h.C_DEG_TO_256,256)};h.log2=function(c){return Math.log(c)*a};h.sqr=function(a){return a*a};h.clamp=function(a,d,e){return Math.min(Math.max(a,d),e)};h.interpolate=function(a,d,e){return a*(1-e)+d*e};h.between=function(a,d,e){return a>=d&&a<=e||a>=e&&a<=d}})},"esri/views/2d/engine/webgl/CIMSymbolDrawHelper":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/decorateHelper ./Rect ./GeometryUtils".split(" "),
function(n,h,d,a,c,g){Object.defineProperty(h,"__esModule",{value:!0});var e=function(){function a(a){this._t=a}a.createIdentity=function(){return new a([1,0,0,0,1,0])};a.prototype.clone=function(){return new a(this._t.slice())};a.prototype.transform=function(a){var b=this._t;return[b[0]*a[0]+b[1]*a[1]+b[2],b[3]*a[0]+b[4]*a[1]+b[5]]};a.createScale=function(b,c){return new a([b,0,0,0,c,0])};a.prototype.scale=function(a,c){var b=this._t;b[0]*=a;b[1]*=a;b[2]*=a;b[3]*=c;b[4]*=c;b[5]*=c;return this};a.prototype.scaleRatio=
function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};a.createTranslate=function(b,c){return new a([0,0,b,0,0,c])};a.prototype.translate=function(a,c){var b=this._t;b[2]+=a;b[5]+=c;return this};a.createRotate=function(b){var c=Math.cos(b);b=Math.sin(b);return new a([c,-b,0,b,c,0])};a.prototype.rotate=function(b){return this.multiply(a.createRotate(b))};a.prototype.multiply=function(a){var b=this._t;a=a._t;var c=b[1]*a[0]+b[4]*a[1],d=b[2]*a[0]+b[5]*a[1]+a[2],e=b[0]*a[3]+b[3]*a[4],
f=b[1]*a[3]+b[4]*a[4],g=b[2]*a[3]+b[5]*a[4]+a[5];b[0]=b[0]*a[0]+b[3]*a[1];b[1]=c;b[2]=d;b[3]=e;b[4]=f;b[5]=g;return this};return a}();h.Transformation=e;n=function(){function a(a){this._transfos=[];this._sizeTransfos=[];this._transfos.push(a||e.createIdentity());this._sizeTransfos.push(a?a.scaleRatio():1)}a.prototype.transformPt=function(a){return this._transfos[this._transfos.length-1].transform(a)};a.prototype.transformSize=function(a){return a*this._sizeTransfos[this._sizeTransfos.length-1]};a.prototype.back=
function(){return this._transfos[this._transfos.length-1]};a.prototype.push=function(a){var b=a.scaleRatio();a.multiply(this.back());this._transfos.push(a);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*b)};a.prototype.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};a.prototype.drawSolidFill=function(a,c){};a.prototype.drawSolidStroke=function(a,c,d){};a.prototype.drawSymbol=function(a,c){if(a)switch(a.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(a,
c)}};a.prototype.drawMultiLayerSymbol=function(a,c){if(a&&(a=a.symbolLayers))for(var b=a.length;b--;){var d=a[b];if(d&&d.enable)switch(d.type){case "CIMSolidFill":this.drawSolidFill(c,d.color);break;case "CIMSolidStroke":this.drawSolidStroke(c,d.color,d.width);break;case "CIMVectorMarker":this.drawVectorMarker(d,c)}}};a.prototype.drawVectorMarker=function(a,c){if(a){var b=a.markerGraphics;if(b){var d=a.size,f=a.frame,k=f?f.ymax-f.ymin:0,k=d&&k?d/k:1,h=e.createIdentity();f&&h.translate(.5*-(f.xmax+
f.xmin),.5*-(f.ymax+f.ymin));var r=a.anchorPt;if(r){var n=r.x,r=r.y;"relative"===a.anchorPtUnits&&f&&(n*=(f.xmax-f.xmin)*k,r*=d);h.translate(-n,-r)}1!==k&&h.scale(k,k);a.rotation&&h.rotate(a.rotation*g.C_DEG_TO_RAD);h.translate(a.offsetX||0,a.offsetY||0);h.translate(c.x,c.y);this.push(h);for(a=0;a<b.length;a++)(c=b[a])&&this.drawSymbol(c.symbol,c.geometry);this.pop()}}};return a}();h.CIMSymbolDrawHelper=n;a=function(a){function b(){var b=a.call(this)||this;b._xmin=b._ymin=Infinity;b._xmax=b._ymax=
-Infinity;return b}d(b,a);b.prototype.envelope=function(){return new c(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};b.prototype._merge=function(a,b){a[0]-b<this._xmin&&(this._xmin=a[0]-b);a[0]+b>this._xmax&&(this._xmax=a[0]+b);a[1]-b<this._ymin&&(this._ymin=a[1]-b);a[1]+b>this._ymax&&(this._ymax=a[1]+b)};b.prototype.drawSolidFill=function(a,b){b=0;for(a=a.rings;b<a.length;b++){var c=a[b],d=c?c.length:0;if(2<d){this._merge(this.transformPt(c[0]),0);for(var e=1;e<d;++e)this._merge(this.transformPt(c[e]),
0)}}};b.prototype.drawSolidStroke=function(a,b,c){b=.5*this.transformSize(c);c=0;for(a=a.rings||a.paths;c<a.length;c++){var d=a[c],e=d?d.length:0;if(1<e){this._merge(this.transformPt(d[0]),b);for(var f=1;f<e;++f)this._merge(this.transformPt(d[f]),b)}}};return b}(n);h.EnvDrawHelper=a;n=function(a){function b(b,c){c=a.call(this,c)||this;c._ctx=b;return c}d(b,a);b.prototype.drawSolidFill=function(a,b){var c=this._ctx;c.fillStyle="rgba("+Math.round(b[0])+","+Math.round(b[1])+","+Math.round(b[2])+","+
b[3]/255+")";c.beginPath();b=0;for(a=a.rings;b<a.length;b++){var d=a[b],e=d?d.length:0;if(2<e){var f=this.transformPt(d[0]);c.moveTo(f[0],f[1]);for(var g=1;g<e;++g)f=this.transformPt(d[g]),c.lineTo(f[0],f[1]);c.closePath()}}c.fill("evenodd")};b.prototype.drawSolidStroke=function(a,b,c){var d=this._ctx;d.strokeStyle="rgba("+Math.round(b[0])+","+Math.round(b[1])+","+Math.round(b[2])+","+b[3]/255+")";d.lineWidth=this.transformSize(c)+.5;d.beginPath();b=!!a.rings;c=0;for(a=a.rings||a.paths;c<a.length;c++){var e=
a[c],f=e?e.length:0;if(1<f){var g=this.transformPt(e[0]);d.moveTo(g[0],g[1]);for(var k=1;k<f;++k)g=this.transformPt(e[k]),d.lineTo(g[0],g[1]);b&&d.closePath()}}d.stroke()};return b}(n);h.CanvasDrawHelper=n})},"esri/views/2d/engine/webgl/SDFHelper":function(){define(["require","exports","./Geometry","./Rect"],function(n,h,d,a){function c(a){return a-Math.floor(a)}function g(a,d,g){0>a?a=0:.9999991<a&&(a=.9999991);var b=c(a*e[0]),k=c(a*e[1]),h=c(a*e[2]);a=c(a*e[3]);d[g+0]=256*(b-b*f[0]);d[g+1]=256*
(k-b*f[1]);d[g+2]=256*(h-k*f[2]);d[g+3]=256*(a-h*f[3])}Object.defineProperty(h,"__esModule",{value:!0});var e=[16777216,65536,256,1],f=[0,1/256,1/256,1/256];h.packFloat=g;n=function(){function b(){}b.checkSDF=function(a){return!0};b.prototype._extractGeometry=function(a){if(!a)return null;a=a.symbolLayers;if(!a||1!==a.length)return null;a=a[0];if(!a)return null;a=a.markerGraphics;if(!a||1!==a.length)return null;a=a[0];if(!a)return null;var b=a.geometry;if(!b||!b.rings)return null;a=[];for(var c=0,
b=b.rings;c<b.length;c++){for(var e=[],f=0,g=b[c];f<g.length;f++){var k=g[f];e.push(new d.Point(k[0],k[1]))}a.push(e)}return a};b.prototype._getEnvelope=function(b){for(var c=Infinity,d=-Infinity,e=Infinity,f=-Infinity,g=0;g<b.length;g++)for(var k=0,h=b[g];k<h.length;k++){var n=h[k];n.x<c&&(c=n.x);n.x>d&&(d=n.x);n.y<e&&(e=n.y);n.y>f&&(f=n.y)}return new a(c,e,d-c,f-e)};b.prototype.buildSDF=function(a){a=this._extractGeometry(a);if(!a)return null;var b=this._getEnvelope(a);if(0>=b.width||0>=b.height)return null;
for(var c=Math.floor(31.5),d=(128-2*(c+0+1))/Math.max(b.width,b.height),e=Math.round(b.width*d),f=Math.round(b.height*d),g=e+2*c,k=f+2*c,h=0;h<a.length;h++)for(var n=0,D=a[h];n<D.length;n++){var z=D[n];z.x-=b.x;z.y-=b.y;z.x*=d;z.y*=d;z.x+=c-.5;z.y+=c-.5}b=this._dist_map(a,g,k,c);this._sign_dist_map(a,g,k,c,b);return[this._encodeDistMap(b,c),g,k,e,f,d]};b.prototype._dist_map=function(a,b,c,d){for(var e=b*c,f=new Float32Array(e),g=d*d+1,k=0;k<e;++k)f[k]=g;for(g=0;g<a.length;g++)for(var h=a[g],l=h.length,
k=1;k<l;++k){var m=h[k-1],n=h[k],t=void 0,A=void 0;m.x<n.x?(t=m.x,A=n.x):(t=n.x,A=m.x);var B=void 0,x=void 0;m.y<n.y?(B=m.y,x=n.y):(B=n.y,x=m.y);var v=Math.floor(t)-d,A=Math.floor(A)+d,B=Math.floor(B)-d,x=Math.floor(x)+d;0>v&&(v=0);A>b&&(A=b);0>B&&(B=0);x>c&&(x=c);for(var t=n.x-m.x,F=n.y-m.y,C=t*t+F*F;v<A;v++)for(var I=B;I<x;I++){var E=(v-m.x)*t+(I-m.y)*F,H=void 0,G=void 0;0>E?(H=m.x,G=m.y):E>C?(H=n.x,G=n.y):(E/=C,H=m.x+E*t,G=m.y+E*F);E=(v-H)*(v-H)+(I-G)*(I-G);H=(c-I-1)*b+v;E<f[H]&&(f[H]=E)}}for(k=
0;k<e;++k)f[k]=Math.sqrt(f[k]);return f};b.prototype._sign_dist_map=function(a,b,c,d,e){for(var f=0;f<a.length;f++)for(var g=a[f],k=g.length,h=1;h<k;++h){var l=g[h-1],m=g[h],p=void 0,n=void 0;l.x<m.x?(p=l.x,n=m.x):(p=m.x,n=l.x);var t=void 0,B=void 0;l.y<m.y?(t=l.y,B=m.y):(t=m.y,B=l.y);p=Math.floor(p);n=Math.floor(n)+1;t=Math.floor(t);B=Math.floor(B)+1;p<d&&(p=d);n>b-d&&(n=b-d);t<d&&(t=d);for(B>c-d&&(B=c-d);t<B;++t)if(l.y>t!==m.y>t){for(var x=(c-t-1)*b,v=p;v<n;++v)v<(m.x-l.x)*(t-l.y)/(m.y-l.y)+l.x&&
(e[x+v]=-e[x+v]);for(v=d;v<p;++v)e[x+v]=-e[x+v]}}};b.prototype._encodeDistMap=function(a,b){b*=2;for(var c=a.length,d=new Uint8Array(4*c),e=0;e<c;++e)g(.5-a[e]/b,d,4*e);return d};return b}();h.SDFHelper=n})},"esri/views/2d/engine/webgl/Geometry":function(){define(["require","exports"],function(n,h){Object.defineProperty(h,"__esModule",{value:!0});n=function(){function d(a,c){this.x=a;this.y=c}d.prototype.clone=function(){return new d(this.x,this.y)};d.prototype.equals=function(a,c){return a===this.x&&
c===this.y};d.prototype.isEqual=function(a){return a.x===this.x&&a.y===this.y};d.prototype.setCoords=function(a,c){this.x=a;this.y=c};d.prototype.normalize=function(){var a=this.x,c=this.y,a=Math.sqrt(a*a+c*c);this.x/=a;this.y/=a};d.prototype.rightPerpendicular=function(){var a=this.x;this.x=this.y;this.y=-a};d.prototype.move=function(a,c){this.x+=a;this.y+=c};d.prototype.assign=function(a){this.x=a.x;this.y=a.y};d.prototype.assignAdd=function(a,c){this.x=a.x+c.x;this.y=a.y+c.y};d.prototype.assignSub=
function(a,c){this.x=a.x-c.x;this.y=a.y-c.y};d.prototype.rotate=function(a,c){var d=this.x,e=this.y;this.x=d*a-e*c;this.y=d*c+e*a};d.prototype.scale=function(a){this.x*=a;this.y*=a};d.prototype.length=function(){var a=this.x,c=this.y;return Math.sqrt(a*a+c*c)};d.distance=function(a,c){var d=c.x-a.x;a=c.y-a.y;return Math.sqrt(d*d+a*a)};d.add=function(a,c){return new d(a.x+c.x,a.y+c.y)};d.sub=function(a,c){return new d(a.x-c.x,a.y-c.y)};return d}();h.Point=n})},"esri/views/2d/engine/webgl/GlyphSource":function(){define(["require",
"exports","../../../../core/promiseUtils","../../../../request","../../../../core/pbf"],function(n,h,d,a,c){var g=function(){function a(a){this._metrics=[];for(this._bitmaps=[];a.next();)switch(a.tag()){case 1:for(var b=a.getMessage();b.next();)switch(b.tag()){case 3:for(var c=b.getMessage(),d=void 0,e=void 0,f=void 0,g=void 0,h=void 0,n=void 0,w=void 0;c.next();)switch(c.tag()){case 1:d=c.getUInt32();break;case 2:e=c.getBytes();break;case 3:f=c.getUInt32();break;case 4:g=c.getUInt32();break;case 5:h=
c.getSInt32();break;case 6:n=c.getSInt32();break;case 7:w=c.getUInt32();break;default:c.skip()}d&&(this._metrics[d]={width:f,height:g,left:h,top:n,advance:w},this._bitmaps[d]=e);break;default:b.skip()}break;default:a.skip()}}a.prototype.getMetrics=function(a){return this._metrics[a]};a.prototype.getBitmap=function(a){return this._bitmaps[a]};return a}(),e=function(){function a(){this._ranges=[]}a.prototype.getRange=function(a){return this._ranges[a]};a.prototype.addRange=function(a,c){this._ranges[a]=
c};return a}();return function(){function f(a){this._glyphInfo={};this._baseURL=a}f.prototype.getRange=function(b,e){var f=this._getFontStack(b);if(f.getRange(e))return d.resolve();var k=256*e,h=k+255;b=this._baseURL.replace("{fontstack}",b).replace("{range}",k+"-"+h);return a(b,{callbackParamName:"callback",responseType:"array-buffer"}).then(function(a){f.addRange(e,new g(new c(new Uint8Array(a.data),new DataView(a.data))))})};f.prototype.getGlyph=function(a,c){if(a=this._getFontStack(a)){var b=
Math.floor(c/256);if(!(256<b)&&(a=a.getRange(b)))return{metrics:a.getMetrics(c),bitmap:a.getBitmap(c)}}};f.prototype._getFontStack=function(a){var b=this._glyphInfo[a];b||(b=this._glyphInfo[a]=new e);return b};return f}()})},"esri/core/pbf":function(){define(["require","exports"],function(n,h){return function(){function d(a,c,d,e){this._tag=0;this._dataType=99;this._data=a;this._dataView=c;this._pos=d||0;this._end=e||a.byteLength}d.prototype.clone=function(){return new d(this._data,this._dataView,
this._pos,this._end)};d.prototype.next=function(a){for(;;){if(this._pos===this._end)return!1;var c=this._decodeVarint();this._tag=c>>3;this._dataType=c&7;if(!a||a===this._tag)break;this.skip()}return!0};d.prototype.empty=function(){return this._pos>=this._end};d.prototype.tag=function(){return this._tag};d.prototype.getInt32=function(){return this._decodeVarint()};d.prototype.getInt64=function(){return this._decodeVarint()};d.prototype.getUInt32=function(){return this._decodeVarint()};d.prototype.getUInt64=
function(){return this._decodeVarint()};d.prototype.getSInt32=function(){return this._decodeSVarint()};d.prototype.getSInt64=function(){return this._decodeSVarint()};d.prototype.getBool=function(){var a=0!==this._data[this._pos];this._skip(1);return a};d.prototype.getEnum=function(){return this._decodeVarint()};d.prototype.getFixed64=function(){var a=this._dataView,c=this._pos,a=a.getUint32(c,!0)+4294967296*a.getUint32(c+4,!0);this._skip(8);return a};d.prototype.getSFixed64=function(){var a=this._dataView,
c=this._pos,a=a.getUint32(c,!0)+4294967296*a.getInt32(c+4,!0);this._skip(8);return a};d.prototype.getDouble=function(){var a=this._dataView.getFloat64(this._pos,!0);this._skip(8);return a};d.prototype.getFixed32=function(){var a=this._dataView.getUint32(this._pos,!0);this._skip(4);return a};d.prototype.getSFixed32=function(){var a=this._dataView.getInt32(this._pos,!0);this._skip(4);return a};d.prototype.getFloat=function(){var a=this._dataView.getFloat32(this._pos,!0);this._skip(4);return a};d.prototype.getString=
function(){var a=this._getLength(),c=this._pos,c=this._toString(this._data,c,c+a);this._skip(a);return c};d.prototype.getBytes=function(){var a=this._getLength(),c=this._pos,c=this._toBytes(this._data,c,c+a);this._skip(a);return c};d.prototype.getMessage=function(){var a=this._getLength(),c=this._pos,c=new d(this._data,this._dataView,c,c+a);this._skip(a);return c};d.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());
break;case 5:this._skip(4);break;default:throw Error("Invalid data type!");}};d.prototype._skip=function(a){if(this._pos+a>this._end)throw Error("Attempt to skip past the end of buffer!");this._pos+=a};d.prototype._decodeVarint=function(){var a=this._data,c=this._pos,d=0,e;if(10<=this._end-c){if(e=a[c++],d|=e&127,0!==(e&128)&&(e=a[c++],d|=(e&127)<<7,0!==(e&128)&&(e=a[c++],d|=(e&127)<<14,0!==(e&128)&&(e=a[c++],d|=(e&127)<<21,0!==(e&128)&&(e=a[c++],d+=268435456*(e&127),0!==(e&128)&&(e=a[c++],d+=34359738368*
(e&127),0!==(e&128)&&(e=a[c++],d+=4398046511104*(e&127),0!==(e&128)&&(e=a[c++],d+=562949953421312*(e&127),0!==(e&128)&&(e=a[c++],d+=72057594037927936*(e&127),0!==(e&128)&&(e=a[c++],d+=0x7fffffffffffffff*(e&127),0!==(e&128)))))))))))throw Error("Varint too long!");}else{for(var f=1;c!==this._end;){e=a[c];if(0===(e&128))break;++c;d+=(e&127)*f;f*=128}if(c===this._end)throw Error("Varint overrun!");++c;d+=e*f}this._pos=c;return d};d.prototype._decodeSVarint=function(){var a=this._decodeVarint();return a%
2?-(a+1)/2:a/2};d.prototype._getLength=function(){if(2!==this._dataType)throw Error("Not a delimited data type!");return this._decodeVarint()};d.prototype._toString=function(a,c,d){var e="",f="";for(d=Math.min(this._end,d);c<d;++c){var b=a[c];b&128?f+="%"+b.toString(16):(e+=decodeURIComponent(f)+String.fromCharCode(b),f="")}f.length&&(e+=decodeURIComponent(f));return e};d.prototype._toBytes=function(a,c,d){d=Math.min(this._end,d);return new Uint8Array(a.buffer,c,d-c)};return d}()})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("require exports dojo/promise/all dojo/has ../../../webgl/Texture ./Rect ./RectangleBinPack".split(" "),
function(n,h,d,a,c,g,e){var f;a("stable-symbol-rendering")&&(f=new Set);return function(){function b(a,b,c){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphIndex={};this._textures=[];this._rangePromises=new Map;(0>=a||0>=b)&&console.error("Glyph mosaic width and height must be greater than zero!");this.width=a;this.height=b;this._glyphSource=c;this._binPack=new e(a-4,b-4);this._glyphData.push(new Uint8Array(a*b));this._dirties.push(!0);this._textures.push(void 0)}
b.prototype.getGlyphItems=function(b,c){var h=this,k=[],m=this._glyphSource,n=new Set;b=1/256;for(var r=0;r<c.length;r++)n.add(Math.floor(c[r]*b));var u=[];n.forEach(function(a){if(256>=a){var b="Arial Regular"+a;h._rangePromises.has(b)?u.push(h._rangePromises.get(b)):(a=m.getRange("Arial Regular",a).always(function(){h._rangePromises["delete"](b)}),h._rangePromises.set(b,a),u.push(a))}});return d(u).then(function(b){b=h._glyphIndex["Arial Regular"];b||(b={},h._glyphIndex["Arial Regular"]=b);var d;
if(a("stable-symbol-rendering")){f.clear();for(var l=0;l<c.length;l++)d=c[l],f.add(d);var p=[];n.forEach(function(a){p.push(a)});p.sort();d=[];for(l=0;l<p.length;l++)for(var q=p[l],r=0;256>r;++r)d.push(256*q+r)}else d=c;l=0;for(q=d;l<q.length;l++)if(d=q[l],r=b[d]){if(!a("stable-symbol-rendering")||f.has(d))k[d]={rect:r.rect,metrics:r.metrics,page:r.page}}else{var t=m.getGlyph("Arial Regular",d);if(t&&t.metrics){var r=t.metrics,x=void 0;if(0===r.width)x=new g(0,0,0,0);else{var v=r.width+6,F=r.height+
6,C=v%4?4-v%4:4,u=F%4?4-F%4:4;1===C&&(C=5);1===u&&(u=5);x=h._binPack.allocate(v+C,F+u);x.isEmpty&&(h._dirties[h._currentPage]||(h._glyphData[h._currentPage]=null),h._currentPage=h._glyphData.length,h._glyphData.push(new Uint8Array(h.width*h.height)),h._dirties.push(!0),h._textures.push(void 0),h._binPack=new e(h.width-4,h.height-4),x=h._binPack.allocate(v+C,F+u));var C=h._glyphData[h._currentPage],t=t.bitmap,E=u=void 0;if(t)for(var w=0;w<F;w++)for(var u=v*w,E=h.width*(x.y+w+1)+x.x,G=0;G<v;G++)C[E+
G+1]=t[u+G]}b[d]={rect:x,metrics:r,tileIDs:null,page:h._currentPage};if(!a("stable-symbol-rendering")||f.has(d))k[d]={rect:x,metrics:r,page:h._currentPage};h._dirties[h._currentPage]=!0}}return k})};b.prototype.bind=function(a,b,d,e){this._textures[d]||(this._textures[d]=new c(a,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));var f=this._textures[d];f.setSamplingMode(b);this._dirties[d]&&f.setData(this._glyphData[d]);a.bindTexture(f,e);
this._dirties[d]=!1};b.prototype.dispose=function(){this._binPack=null;for(var a=0,b=this._textures;a<b.length;a++){var c=b[a];c&&c.dispose()}this._textures.length=0};return b}()})},"*noref":1}});
define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/tsSupport/assignHelper ../../../../core/accessorSupport/decorators ../../../../core/HandleRegistry ../../../../core/promiseUtils ../../../../core/Logger ../../../../Graphic ../../../../layers/support/TileInfo ../../../../renderers/support/diffUtils ../../engine/StageGL ../../engine/webgl/rendererInfoUtils ../../engine/webgl/visualVariablesUtils ../../engine/webgl/TileHandler ../../engine/webgl/WGLTile ../../engine/webgl/WGLFeatureView ../../tiling/TileQueue ../../tiling/TileInfoView ../../tiling/TileStrategy ../LayerView2D".split(" "),function(n,
h,d,a,c,g,e,f,b,k,m,l,t,p,q,r,u,w,y,D,z,J){var A=b.getLogger("esri.views.2d.layers.FeatureLayerView2D");return function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;a._tileRequests=new Map;a._hasVV=!1;a._handles=new e;a._wglFeatureView=new w(512,512,a);a.container=new t;return a}d(c,b);c.prototype.initialize=function(){this._tileHandler=new r(this,this._wglFeatureView,512,512,1,1);this.addResolvingPromise(this._tileHandler.start())};c.prototype.destroy=function(){this._tileHandler.stop();
this._tileHandler=null};Object.defineProperty(c.prototype,"numFeatures",{get:function(){var a=0;this.attached?this._tileStrategy.tiles.forEach(function(b){a+=b.iconDisplayRecords?b.iconDisplayRecords.length:0}):0;return a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"visualVariablesInfo",{get:function(){return this._visualVariablesInfo},enumerable:!0,configurable:!0});c.prototype.highlight=function(a){var b=this._wglFeatureView;b.addHighlight(a);return{remove:function(){b.removeHighlight(a)}}};
c.prototype.hitTest=function(a,b){var c=this;return this.suspended?f.resolve(null):this._wglFeatureView.hitTest(a,b).then(function(a){return 0===a.length?null:c._tileHandler.getFeatures(a).then(function(a){if(0===a.features.length)return null;a=k.fromJSON(a.features[0]);a.layer=c.layer;a.geometry.spatialReference=c.view.spatialReference;return a})})};c.prototype.update=function(a){!this._configurationPromise&&this._fetchQueue&&(this._fetchQueue.pause(),this._fetchQueue.state=a.state,this._tileStrategy.update(a),
this._fetchQueue.resume(),this.notifyChange("numFeatures"),this.notifyChange("updating"))};c.prototype.attach=function(){var a=this,b=this._tileInfo=m.create({spatialReference:this.view.spatialReference,size:512});this._tileInfoView=new D(b);this._wglFeatureView.highlightOptions=this.view.highlightOptions;this._wglFeatureView.initialize(this._tileInfoView);this._configure(this.layer.renderer);this._normalizedRenderer=p.getNormalizedRenderer(this.layer.renderer,this.view.spatialReference);this._visualVariablesInfo=
q.convertVisualVariables(this._normalizedRenderer.visualVariables);this._handles.add(this.layer.watch("renderer",function(b){return a._rendererChangeHhandler(b)}));this._handles.add(this.layer.watch("definitionExpression, processing, outFields",function(b,c,d){"outFields"!==d?a.refresh():b.sort().join()!==c.sort().join()&&a.refresh()}))};c.prototype.detach=function(){this.container.removeChild(this._wglFeatureView);this._tileHandler.stop();this._tileStrategy.destroy();this._tileStrategy=null;this._handles.removeAll()};
c.prototype.moveStart=function(){this.requestUpdate()};c.prototype.viewChange=function(){this.requestUpdate()};c.prototype.moveEnd=function(){this.requestUpdate()};c.prototype.isUpdating=function(){return this._fetchQueue&&0!==this._fetchQueue.length};c.prototype.refresh=function(){var a=this;this._configure(this.layer.renderer).then(function(){a._fetchQueue.resume();a._wglFeatureView.requestRender();a.requestUpdate()})};c.prototype.acquireTile=function(a){var b=this,c=this._tileInfoView.getTileBounds([0,
0,0,0],a),d=u.pool.acquire(a,c,512,512,512);a=this._fetchQueue.push(d.key).then(function(a){a&&d.setData(a,b._hasVV,!1);b._wglFeatureView.addChild(d);d.once("attach",function(){b.notifyChange("updating");b.requestUpdate()});b.notifyChange("updating")}).otherwise(function(a){"cancel"!==a.dojoType&&A.error("query-error",a)});this._tileRequests.set(d.key.id,a);this.notifyChange("updating");return d};c.prototype.releaseTile=function(a){var b=this,c=a.key.id,d=this._tileRequests.get(c);d&&(d.isFulfilled()||
d.cancel(),this._tileRequests.delete(c),this._wglFeatureView.removeChild(a),this.requestUpdate(),a.once("detach",function(){b._tileHandler.removeTile(a.key);u.pool.release(a)}),this.notifyChange("updating"))};c.prototype._configure=function(a){var b=this;this._configurationPromise&&(this._configurationPromise.cancel(),this._configurationPromise=null);this._fetchQueue&&(this._fetchQueue.pause(),this._fetchQueue.clear(),this._tileStrategy.clear());return this._configurationPromise=this._tileHandler.configure(this.layer.renderer,
this.layer.processing).then(function(){b._fetchQueue||(b._fetchQueue=new y({tileInfoView:b._tileInfoView,concurrency:50,process:function(a){return b._tileHandler.registerTile(a)}}),b._tileStrategy=new z({cachePolicy:"purge",acquireTile:function(a){return b.acquireTile(a)},releaseTile:function(a){return b.releaseTile(a)},tileInfoView:b._tileInfoView}),b.container.addChild(b._wglFeatureView));b.requestUpdate()}).always(function(){b._configurationPromise=null})};c.prototype._applyRendererDiff=function(a,
b){var c;a:{for(c in a.diff){var d=a.diff[c];if("collection"===d.type){if(0!==d.changed.length||0!==d.added.length||0!==d.removed.length){c=!0;break a}}else if("visualVariables"!==c&&"authoringInfo"!==c){c=!0;break a}}c=!1}if(c)return!1;if(a.diff.visualVariables){a=b.vvRanges;b=l.diff(this._visualVariablesInfo.vvFields,b.vvFields);this._visualVariablesInfo.vvRanges=a;if(b)return!1;this._wglFeatureView.requestRender()}return!0};c.prototype._rendererChangeHhandler=function(a){a=p.getNormalizedRenderer(a,
this.view.spatialReference);var b=l.diff(this._normalizedRenderer,a);if(b)if("complete"===b.type)this._normalizedRenderer=a,this._visualVariablesInfo=q.convertVisualVariables(a.visualVariables),this.refresh();else if("partial"===b.type){var c=q.convertVisualVariables(a.visualVariables);this._applyRendererDiff(b,c)||(this._normalizedRenderer=a,this._visualVariablesInfo=c,this.refresh())}};a([g.property()],c.prototype,"numFeatures",null);return c=a([g.subclass("esri.views.2d.layers.FeatureLayerView2DWebGL")],
c)}(g.declared(J))});