// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.6/esri/copyright.txt for details.
//>>built
define(["require","exports","./TileKey","../../../geometry/support/spatialReferenceUtils"],function(r,t,e,p){function m(c,a,b){c[0]=a;c[1]=b;return c}return function(){function c(a,b,c,d,f,g,k,l,q,n,e,m){this.level=a;this.resolution=b;this.scale=c;this.origin=d;this.first=f;this.last=g;this.size=k;this.norm=l;this.worldStart=q;this.worldEnd=n;this.worldSize=e;this.wrap=m}c.create=function(a,b,h){var d=p.getInfo(a.spatialReference),f=[a.origin.x,a.origin.y],g=[a.size[0]*b.resolution,a.size[1]*b.resolution],
k=[-Infinity,-Infinity],l=[Infinity,Infinity],e=[Infinity,Infinity];h&&(m(k,Math.max(0,Math.floor((h.xmin-f[0])/g[0])),Math.max(0,Math.floor((f[1]-h.ymax)/g[1]))),m(l,Math.max(0,Math.floor((h.xmax-f[0])/g[0])),Math.max(0,Math.floor((f[1]-h.ymin)/g[1]))),m(e,l[0]-k[0]+1,l[1]-k[1]+1));var n;a.isWrappable?(a=[Math.ceil(Math.round(2*d.origin[1]/b.resolution)/a.size[0]),e[1]],d=[Math.floor((d.origin[0]-f[0])/g[0]),k[1]],h=[a[0]+d[0]-1,l[1]],n=!0):(d=k,h=l,a=e,n=!1);return new c(b.level,b.resolution,b.scale,
f,k,l,e,g,d,h,a,n)};c.prototype.normalizeCol=function(a){if(!this.wrap)return a;var b=this.worldSize[0];return 0>a?b-1-Math.abs((a+1)%b):a%b};c.prototype.denormalizeCol=function(a,b){return this.wrap?this.worldSize[0]*b+a:a};c.prototype.getWorldForColumn=function(a){return this.wrap?Math.floor(a/this.worldSize[0]):0};c.prototype.getFirstColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]};c.prototype.getLastColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]+this.size[0]-
1};c.prototype.getColumnForX=function(a){return(a-this.origin[0])/this.norm[0]};c.prototype.getXForColumn=function(a){return this.origin[0]+a*this.norm[0]};c.prototype.getRowForY=function(a){return(this.origin[1]-a)/this.norm[1]};c.prototype.getYForRow=function(a){return this.origin[1]-a*this.norm[1]};c.prototype.getTileBounds=function(a,b){b=e.pool.acquire(b);var c=this.denormalizeCol(b.col,b.world),d=b.row,f=this.getXForColumn(c),g=this.getYForRow(d+1),c=this.getXForColumn(c+1),d=this.getYForRow(d);
a[0]=f;a[1]=g;a[2]=c;a[3]=d;e.pool.release(b);return a};c.prototype.getTileCoords=function(a,b){b=e.pool.acquire(b);m(a,this.getXForColumn(this.denormalizeCol(b.col,b.world)),this.getYForRow(b.row));e.pool.release(b);return a};return c}()});