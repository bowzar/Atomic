// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.6/esri/copyright.txt for details.
//>>built
define(["require","exports","./Placement"],function(u,v,t){return function(){function k(a,e,f,c,l,b,m,d){this._glyphItems=a;this._maxWidth=e;this._lineHeight=f;this._letterSpacing=c;this._offset=l;this._hAnchor=b;this._vAnchor=m;this._justify=d}k.prototype.getShaping=function(a,e){for(var f=this._letterSpacing,c=this._offset[0],l=this._offset[1],b=[],m=a.length,d=0;d<m;d++){for(var h=a.charCodeAt(d),n=void 0,g=0,r=this._glyphItems;g<r.length&&!(n=r[g][h]);g++);n&&(b.push(new t.ShapedGlyph(h,c,l,n)),
c+=n.metrics.advance+f)}if(0<b.length){n=this._maxWidth;a=this._lineHeight;c=this._justify;l=b.length;h=m=f=0;if(0!==n)for(d=r=g=0;d<l;d++){var p=b[d];p.x-=r;p.y=e?p.y-a*f:p.y+a*f;if(p.x>n&&0<g){for(var k=b[g+1].x,h=Math.max(k,h),q=g+1;q<=d;q++)b[q].y=e?b[q].y-a:b[q].y+a,b[q].x-=k;c&&this._applyJustification(b,m,g-1);m=g+1;g=0;r+=k;f++}32===p.glyph&&(g=d)}d=b[l-1];h=Math.max(h,d.x+d.glyphItem.metrics.advance);c&&this._applyJustification(b,m,l-1);d=(c-this._hAnchor)*h;c=(-this._vAnchor*(f+1)+.5)*a;
e&&f&&(c+=f*a);for(e=0;e<b.length;e++)a=b[e],a.x+=d,a.y+=c}return b};k.prototype._applyJustification=function(a,e,f){for(var c=a[f],c=(c.x+c.glyphItem.metrics.advance)*this._justify;e<=f;e++)a[e].x-=c};return k}()});