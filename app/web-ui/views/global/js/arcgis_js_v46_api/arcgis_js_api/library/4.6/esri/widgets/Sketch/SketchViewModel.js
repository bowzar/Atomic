// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.6/esri/copyright.txt for details.
//>>built
define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../views/2d/draw/Draw ../../core/Evented ../../Graphic ../../core/HandleRegistry ../../geometry/Multipoint ../../geometry/Point ../../geometry/Polygon ../../geometry/Polyline ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol ../../symbols/SimpleMarkerSymbol".split(" "),function(y,z,l,f,e,m,n,p,d,q,r,h,t,u,v,w,x){var g=function(){return function(d,
c){this.geometry=d;this.graphic=c;this.type="draw-complete"}}();return function(k){function c(a){a=k.call(this,a)||this;a._actionHandles=new q;a._graphics=null;a.draw=null;a.graphic=null;a.layer=null;a.pointSymbol=new x;a.polygonSymbol=new v;a.polylineSymbol=new w;a.view=null;return a}l(c,k);c.prototype.initialize=function(){this.draw=new n({view:this.view});this._setGraphicsCollection();this.watch("layer",this._setGraphicsCollection)};c.prototype.destroy=function(){this.reset();this._actionHandles.destroy();
this._actionHandles=null;this.draw&&(this.draw.destroy(),this.draw=null);this.view=null;this.emit("destroy")};Object.defineProperty(c.prototype,"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,configurable:!0});c.prototype.complete=function(){this.get("draw.activeAction")&&this.draw.activeAction.complete();this._actionHandles.removeAll();this.draw.reset()};c.prototype.create=function(a){this.reset();"point"===a?this._createPoint():"polygon"===a?this._createPolygon():
"polyline"===a?this._createPolyline():"multipoint"===a?this._createMultipoint():"rectangle"===a&&this._createRectangle()};c.prototype.reset=function(){this.graphic&&this.get("view.graphics")&&(this._graphics.remove(this.graphic),this._set("graphic",null));this._actionHandles.removeAll();this.draw.reset()};c.prototype._createPoint=function(){var a=this,c=this.draw.create("point");this._actionHandles.add([c.on("cursor-update",function(b){a._graphics.remove(a.graphic);b=b.coordinates;b=new h({x:b[0],
y:b[1],spatialReference:a.view.spatialReference});a._set("graphic",new d(b,a.pointSymbol));a._graphics.add(a.graphic)}),c.on("draw-complete",function(b){a._graphics.remove(a.graphic);b=b.coordinates;b=new h({x:b[0],y:b[1],spatialReference:a.view.spatialReference});a._set("graphic",new d(b,a.pointSymbol));a.emit("draw-complete",new g(b,a.graphic.clone()));a._actionHandles.removeAll()})])};c.prototype._createPolygon=function(){var a=this,c=this.draw.create("polygon");this._actionHandles.add([c.on("vertex-add",
function(b){a._graphics.remove(a.graphic);a._set("graphic",new d(a._createPolygonFromVertices(b.vertices),a.polygonSymbol));a._graphics.add(a.graphic)}),c.on("vertex-remove",function(b){a._graphics.remove(a.graphic);a._set("graphic",new d(a._createPolygonFromVertices(b.vertices),a.polygonSymbol));a._graphics.add(a.graphic)}),c.on("cursor-update",function(b){a._graphics.remove(a.graphic);a._set("graphic",new d(a._createPolygonFromVertices(b.vertices),a.polygonSymbol));a._graphics.add(a.graphic)}),
c.on("draw-complete",function(b){a._graphics.remove(a.graphic);b=a._createPolygonFromVertices(b.vertices);a._set("graphic",new d(b,a.polygonSymbol));a.emit("draw-complete",new g(b,a.graphic.clone()));a._actionHandles.removeAll()})])};c.prototype._createPolyline=function(){var a=this,c=this.draw.create("polyline");this._actionHandles.add([c.on("vertex-add",function(b){a._graphics.remove(a.graphic);a._set("graphic",new d(a._createPolylineFromVertices(b.vertices),a.polylineSymbol));a._graphics.add(a.graphic)}),
c.on("vertex-remove",function(b){a._graphics.remove(a.graphic);a._set("graphic",new d(a._createPolylineFromVertices(b.vertices),a.polylineSymbol));a._graphics.add(a.graphic)}),c.on("cursor-update",function(b){a._graphics.remove(a.graphic);a._set("graphic",new d(a._createPolylineFromVertices(b.vertices),a.polylineSymbol));a._graphics.add(a.graphic)}),c.on("draw-complete",function(b){a._graphics.remove(a.graphic);b=a._createPolylineFromVertices(b.vertices);a._set("graphic",new d(b,a.polylineSymbol));
a.emit("draw-complete",new g(b,a.graphic.clone()));a._actionHandles.removeAll()})])};c.prototype._createRectangle=function(){var a=this,c=this.draw.create("rectangle");this._actionHandles.add([c.on("cursor-update",function(b){a._graphics.remove(a.graphic);b.vertices.length&&(a._set("graphic",new d(a._createPolygonFromVertices(b.vertices),a.polygonSymbol)),a._graphics.add(a.graphic))}),c.on("draw-complete",function(b){a._graphics.remove(a.graphic);var c=null,e=null;b.vertices.length&&(c=a._createPolygonFromVertices(b.vertices),
e=new d(c,a.polygonSymbol));a._set("graphic",e);b=e?e.clone():null;a.emit("draw-complete",new g(c,b));a._actionHandles.removeAll()})])};c.prototype._createMultipoint=function(){var a=this,c=this.draw.create("multipoint");this._actionHandles.add([c.on("vertex-add",function(b){a._graphics.remove(a.graphic);a._set("graphic",new d(a._createMultipointFromVertices(b.vertices),a.pointSymbol));a._graphics.add(a.graphic)}),c.on("vertex-remove",function(b){a._graphics.remove(a.graphic);a._set("graphic",new d(a._createMultipointFromVertices(b.vertices),
a.pointSymbol));a._graphics.add(a.graphic)}),c.on("cursor-update",function(b){a._graphics.remove(a.graphic);a._set("graphic",new d(a._createMultipointFromVertices(b.vertices),a.pointSymbol));a._graphics.add(a.graphic)}),c.on("draw-complete",function(b){a._graphics.remove(a.graphic);b=a._createMultipointFromVertices(b.vertices);a._set("graphic",new d(b,a.pointSymbol));a.emit("draw-complete",new g(b,a.graphic.clone()));a._actionHandles.removeAll()})])};c.prototype._createPolylineFromVertices=function(a){return new u({paths:a,
spatialReference:this.view.spatialReference})};c.prototype._createPolygonFromVertices=function(a){a=a.slice(0);a.push(a[0]);return new t({rings:a,spatialReference:this.view.spatialReference})};c.prototype._createMultipointFromVertices=function(a){return new r({points:a,spatialReference:this.view.spatialReference})};c.prototype._setGraphicsCollection=function(){this._graphics=this.layer&&this.layer.graphics?this.layer.graphics:this.view.graphics};f([e.property()],c.prototype,"draw",void 0);f([e.property()],
c.prototype,"graphic",void 0);f([e.property()],c.prototype,"layer",void 0);f([e.property()],c.prototype,"pointSymbol",void 0);f([e.property()],c.prototype,"polygonSymbol",void 0);f([e.property()],c.prototype,"polylineSymbol",void 0);f([e.property({dependsOn:["view.ready"],readOnly:!0})],c.prototype,"state",null);f([e.property()],c.prototype,"view",void 0);return c=f([e.subclass("esri.views.2d.SketchViewModel")],c)}(e.declared(m,p))});