// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.6/esri/copyright.txt for details.
//>>built
define("require exports dojox/gfx/_base ../SimpleMarkerSymbol ../../core/promiseUtils ../../core/Error ../../core/screenUtils ./renderUtils ./previewUtils ./gfxUtils".split(" "),function(B,q,x,m,v,y,n,z,A,t){Object.defineProperty(q,"__esModule",{value:!0});q.previewSymbol2D=function(f,l){var c=l&&l.size?n.pt2px(l.size):null,k=l&&l.maxSize?n.pt2px(l.maxSize):null,b=t.getStroke(f),g={shape:null,fill:null,stroke:b};b&&b.width&&(b.width=Math.min(b.width,80));var e=0,d=0,h=b&&b.width||0,q=!1,w=null;switch(f.type){case "simple-marker":var a=
m.defaultProps,b=f.style,d=e=c=Math.min(c||n.pt2px(f.size||a.size),k||120);switch(b){case m.STYLE_CIRCLE:g.shape={type:"circle",cx:0,cy:0,r:.5*c};break;case m.STYLE_CROSS:g.shape={type:"path",path:[{command:"M",values:[0,.5*d]},{command:"L",values:[e,.5*d]},{command:"M",values:[.5*e,0]},{command:"L",values:[.5*e,d]},{command:"E",values:[]}]};break;case m.STYLE_DIAMOND:g.shape={type:"path",path:[{command:"M",values:[0,.5*d]},{command:"L",values:[.5*e,0]},{command:"L",values:[e,.5*d]},{command:"L",
values:[.5*e,d]},{command:"Z",values:[]}]};break;case m.STYLE_SQUARE:g.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[e,0]},{command:"L",values:[e,d]},{command:"L",values:[0,d]},{command:"Z",values:[]}]};break;case m.STYLE_X:g.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[e,d]},{command:"M",values:[e,0]},{command:"L",values:[0,d]},{command:"E",values:[]}]};break;case m.STYLE_PATH:q=!0,g.shape={type:"path",path:f.path||""}}break;case "simple-line":h=
Math.min(c||h,k||80);e=22<h?2*h:40;d=h;b.width=h;h=0;g.shape={type:"path",path:[{command:"M",values:[0,.5*d]},{command:"L",values:[e,.5*d]},{command:"E",values:[]}]};break;case "picture-fill":case "simple-fill":g.shape=A.shapes.fill[0];break;case "picture-marker":k=k||120;b=n.pt2px(f.width);a=n.pt2px(f.height);c=Math.min(c||Math.max(b,a),k);a=b/a;b=1>=a?Math.ceil(c*a):c;a=1>=a?c:Math.ceil(c/a);e=b;d=a;w=l.opacity;g.shape={type:"image",x:-Math.round(b/2),y:-Math.round(a/2),width:b,height:a,src:f.url||
""};break;case "text":for(var b=f.text||"Aa",a=f.font,c=Math.min(c||n.pt2px(a.size),k||120),u=k=0;u<b.length;u++)var r=b.charAt(u),r=r===r.toUpperCase()?.7:.5,k=k+c*r;e=k;d=c;g.shape={type:"text",text:b,x:0,y:.25*x.normalizedLength((a?c:0).toString()),align:"middle",decoration:f.decoration||a&&a.decoration,rotated:f.rotated,kerning:f.kerning};g.font=a&&{size:c,style:a.style,decoration:a.decoration,weight:a.weight,family:a.family}}if(!g.shape)return v.reject(new y("symbolPreview: renderPreviewHTML2D",
"symbol not supported."));var e=(e||22)+2*h,d=(d||22)+2*h,p=t.getFill(f),h=f.color,c=null;p&&"pattern"===p.type&&h&&"picture-fill"!==f.type?c=t.getPatternUrlWithColor(p.src,h.toCss(!0)).then(function(a){p.src=a;g.fill=p;return g}):(g.fill=p,c=v.resolve(g));return c.then(function(a){return z.renderSymbol([[a]],[e,d],{node:l&&l.node,scale:q,opacity:w})})}});